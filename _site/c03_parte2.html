<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Sernanp – c03_parte2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R Sernanp</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./header_left.html">
 <span class="menu-text">header</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./header_right.html">
 <span class="menu-text">header_right.qmd</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#manipulación-de-datos-con-tidyverse" id="toc-manipulación-de-datos-con-tidyverse" class="nav-link active" data-scroll-target="#manipulación-de-datos-con-tidyverse">Manipulación de datos con tidyverse</a>
  <ul class="collapse">
  <li><a href="#data-transformation-con-dplyr" id="toc-data-transformation-con-dplyr" class="nav-link" data-scroll-target="#data-transformation-con-dplyr">Data Transformation con dplyr</a>
  <ul class="collapse">
  <li><a href="#dplyr-básico" id="toc-dplyr-básico" class="nav-link" data-scroll-target="#dplyr-básico">Dplyr Básico</a></li>
  <li><a href="#filtrar-filas-con-filter" id="toc-filtrar-filas-con-filter" class="nav-link" data-scroll-target="#filtrar-filas-con-filter">Filtrar filas con filter()</a></li>
  <li><a href="#reordenar-las-filas-con-arrange" id="toc-reordenar-las-filas-con-arrange" class="nav-link" data-scroll-target="#reordenar-las-filas-con-arrange">Reordenar las filas con arrange()</a></li>
  <li><a href="#seleccionar-columnas-con-select" id="toc-seleccionar-columnas-con-select" class="nav-link" data-scroll-target="#seleccionar-columnas-con-select">Seleccionar columnas con select()</a></li>
  <li><a href="#añadir-nuevas-variables-con-mutate" id="toc-añadir-nuevas-variables-con-mutate" class="nav-link" data-scroll-target="#añadir-nuevas-variables-con-mutate">Añadir nuevas variables con mutate()</a></li>
  <li><a href="#resúmenes-agrupados-con-summarise" id="toc-resúmenes-agrupados-con-summarise" class="nav-link" data-scroll-target="#resúmenes-agrupados-con-summarise">Resúmenes agrupados con summarise()</a></li>
  </ul></li>
  <li><a href="#combinación-de-múltiples-operaciones-con-el-pipe" id="toc-combinación-de-múltiples-operaciones-con-el-pipe" class="nav-link" data-scroll-target="#combinación-de-múltiples-operaciones-con-el-pipe">Combinación de múltiples operaciones con el pipe</a>
  <ul class="collapse">
  <li><a href="#valores-faltantes" id="toc-valores-faltantes" class="nav-link" data-scroll-target="#valores-faltantes">Valores faltantes</a></li>
  </ul></li>
  <li><a href="#funciones-de-resumen-útiles" id="toc-funciones-de-resumen-útiles" class="nav-link" data-scroll-target="#funciones-de-resumen-útiles">Funciones de resumen útiles</a>
  <ul class="collapse">
  <li><a href="#agrupación-por-múltiples-variables" id="toc-agrupación-por-múltiples-variables" class="nav-link" data-scroll-target="#agrupación-por-múltiples-variables">Agrupación por múltiples variables</a></li>
  <li><a href="#desagrupar" id="toc-desagrupar" class="nav-link" data-scroll-target="#desagrupar">Desagrupar</a></li>
  <li><a href="#transformaciones-agrupadas-y-filtros" id="toc-transformaciones-agrupadas-y-filtros" class="nav-link" data-scroll-target="#transformaciones-agrupadas-y-filtros">Transformaciones agrupadas (y filtros)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="manipulación-de-datos-con-tidyverse" class="level1">
<h1>Manipulación de datos con tidyverse</h1>
<p style="text-align: justify;">
La mayoría de los paquetes que aprenderá en este apartado son parte del llamado <strong>tidyverse</strong>. Los paquetes de tidyverse comparten una filosofía común de programación de datos y R, y están diseñados para trabajar juntos de forma natural.
</p>
<p>Puedes instalar tidyverse completo con una sola línea de código:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p style="text-align: justify;">
En su propia computadora, escriba esa línea de código en la consola y luego presione Entrar para ejecutarlo. R descargará los paquetes de CRAN y los instalará en su computadora. Si tiene problemas con la instalación, asegúrese de estar conectado a Internet y de que <strong>https://cloud.r-project.org/</strong> no esté bloqueado por su firewall o proxy.
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   1.0.0 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.5.0 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
</div>
<p style="text-align: justify;">
Esto le indica que tidyverse está cargando los paquetes <strong>ggplot2, tibble, tidyr, readr, purrr y dplyr</strong>. Estos consideran los núcleo del tidyverse porque los usará en casi todos los análisis.
</p>
<p style="text-align: justify;">
Los paquetes del tidyverse cambian con bastante frecuencia. Puede ver si hay actualizaciones disponibles y, opcionalmente, instalarlas, ejecutando <strong><code>tidyverse_update()</code></strong>.
</p>
<p style="text-align: justify;">
Toma nota del mensaje de conflictos que se imprime cuando cargas el tidyverse. Te dice que dplyr sobrescribe algunas funciones en base R. Si desea usar la versión base de estas funciones después de cargar dplyr, deberá usar sus nombres completos: <strong><code>stats::filter()</code></strong> y <strong><code>stats::lag()</code></strong>
</p>
<section id="data-transformation-con-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation-con-dplyr">Data Transformation con dplyr</h2>
<p style="text-align: justify;">
</p><p>La visualización es una herramienta importante para la generación de información, pero es raro que obtenga los datos exactamente en la forma correcta que necesita. A menudo, necesitará crear algunas variables o resúmenes nuevos, o tal vez solo desee cambiar el nombre de las variables o reordenar las observaciones para que sea un poco más fácil trabajar con los datos. Aprenderá a hacer todo eso <strong>(¡y más!)</strong> en este apartado, que le enseñará cómo transformar sus datos utilizando el <a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf"><strong>paquete dplyr</strong></a></p>
Para explorar los verbos básicos de manipulación de datos de <strong>dplyr</strong>, usaremos la base de datos de zonas de amortiguamiento. Este marco de datos contiene. Los datos provienen de la <span style="color:blue">Servicio Nacional de Áreas Naturales Protegidas (SERNANP)</span>
<p></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datos será un 'data frame'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>z_amortiguamiento<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">'data/zon_amortiguamiento.csv'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(z_amortiguamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X Codigo                 Area_natur   Periodo                 Base_legal
1 1   RC04                  Ashaninka 2019-2023   R.P. Nº 239-2012-SERNANP
2 2   BP03                 de Pui Pui 2019-2023    R.J. Nº 285-2008 INRENA
3 3   RN12                     Matsés 2023-2027 R.P. Nº 054-2014-SERNANP-J
4 4   RN10         Allpahuayo Mishana 2022-2026    R.J. Nº 159-2007 INRENA
5 5   RN06 de Salinas y Aguada Blanca 2016-2020    R.J. Nº 087-2007 INRENA
6 6   RN02                   de Junín 2008-2012    R.J. Nº 145-2008 INRENA
  Fecha_lega Base_leg00 Fecha_le00               Base_leg01 Fecha_le01
1 2012-12-28       &lt;NA&gt; 1899-12-30 R.P. N° 034-2019-SERNANP 2019-01-29
2 2008-10-28       &lt;NA&gt; 1899-12-30 R.P. N° 033-2019-SERNANP 2019-01-29
3 2014-02-27       &lt;NA&gt; 1899-12-30  R.P N° 320-2022-SERNANP 2022-12-29
4 2007-07-24       &lt;NA&gt; 1899-12-30 R.P. N° 082-2022-SERNANP 2022-03-15
5 2007-04-26       &lt;NA&gt; 1899-12-30 R.P. N° 257-2016-SERNANP 2016-09-14
6 2008-06-03       &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
  Superficie
1  325684.03
2   45367.20
3  231397.76
4   65956.53
5  310242.10
6  100858.12</code></pre>
</div>
</div>
<section id="dplyr-básico" class="level3">
<h3 class="anchored" data-anchor-id="dplyr-básico">Dplyr Básico</h3>
<p>En este capítulo, aprenderá las cinco funciones clave de <strong>dplyr</strong> que le permiten resolver la gran mayoría de sus desafíos de manipulación de datos:</p>
<ul>
<li>Elija observaciones por sus valores (<strong><code>filter()</code></strong>).</li>
<li>Reordenar las filas (<strong><code>arrange()</code></strong>).</li>
<li>Elija las variables por sus nombres (<strong><code>select()</code></strong>).</li>
<li>Crear nuevas variables con funciones de variables existentes (<strong><code>mutate()</code></strong>).</li>
<li>Colapsar muchos valores en un solo resumen (<strong><code>summarize()</code></strong>)</li>
</ul>
<p style="text-align: justify;">
Todos estos se pueden usar junto con <strong><code>group_by()</code></strong>, que cambia el alcance de cada función de operar en todo el conjunto de datos a operar en él grupo por grupo. Estas seis funciones proporcionan los <strong>verbos</strong> para un lenguaje de manipulación de datos.
</p>
<p>Todos los verbos funcionan de manera similar:</p>
<ol type="1">
<li>El primer argumento es un marco de datos.</li>
<li>Los argumentos siguientes describen qué hacer con el marco de datos, utilizando los nombres de las variables <strong>(sin comillas)</strong>.</li>
<li>El resultado es un nuevo dataframe.</li>
</ol>
<p style="text-align: justify;">
Juntas, estas propiedades hacen que sea fácil encadenar varios pasos simples para lograr un resultado complejo. Profundicemos y veamos cómo funcionan estos verbos.
</p>
</section>
<section id="filtrar-filas-con-filter" class="level3">
<h3 class="anchored" data-anchor-id="filtrar-filas-con-filter">Filtrar filas con filter()</h3>
<p align="center">
<img width="500" src="fig/filter.png">
</p>
<p><strong>Filter()</strong>te permite filtrar un subconjunto de observaciones según sus valores. El primer argumento es el nombre del data frame. El segundo y los siguientes argumentos son las expresiones que lo filtran.</p>
<p>Por ejemplo, podemos seleccionar todas las <strong>Superficie igual a 310242.10</strong> con:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento, Superficie <span class="sc">==</span> <span class="fl">310242.10</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X Codigo                 Area_natur   Periodo              Base_legal
1 5   RN06 de Salinas y Aguada Blanca 2016-2020 R.J. Nº 087-2007 INRENA
  Fecha_lega Base_leg00 Fecha_le00               Base_leg01 Fecha_le01
1 2007-04-26       &lt;NA&gt; 1899-12-30 R.P. N° 257-2016-SERNANP 2016-09-14
  Superficie
1   310242.1</code></pre>
</div>
</div>
<p>Cuando ejecutas esa línea de código, dplyr ejecuta la operación de filtrado y devuelve un nuevo data frame. Las funciones de dplyr nunca modifican su input, por lo que si deseas guardar el resultado, necesitarás usar el operador de asignación, &lt;-:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>filter01 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento,Superficie <span class="sc">==</span> <span class="fl">310242.10</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De otro modo usar el operador <strong>“%&gt;%”</strong> de la librería <strong>magrittr</strong>.</p>
<p>R imprime los resultados o los guarda en una variable. Si desea hacer ambas cosas, puede envolver la tarea <strong>entre paréntesis</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r bg-success code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(filter02 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento,Superficie <span class="sc">==</span> <span class="fl">310242.10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X Codigo                 Area_natur   Periodo              Base_legal
1 5   RN06 de Salinas y Aguada Blanca 2016-2020 R.J. Nº 087-2007 INRENA
  Fecha_lega Base_leg00 Fecha_le00               Base_leg01 Fecha_le01
1 2007-04-26       &lt;NA&gt; 1899-12-30 R.P. N° 257-2016-SERNANP 2016-09-14
  Superficie
1   310242.1</code></pre>
</div>
</div>
<section id="comparaciones" class="level4">
<h4 class="anchored" data-anchor-id="comparaciones">Comparaciones</h4>
<p>Para usar el filtrado de manera efectiva, debes saber cómo seleccionar las observaciones que deseas utilizando los operadores de comparación. R proporciona el conjunto estándar: <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>!=</code> (no igual) y <code>==</code> (igual).</p>
<p>Cuando comienzas con R, el error más fácil de cometer es usar <code>=</code> en lugar de <code>==</code> cuando se busca igualdad. Cuando esto suceda, obtendrás un error informativo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento,<span class="at">Superficie =</span> <span class="fl">310242.10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `dplyr::filter()`:
! We detected a named input.
ℹ This usually means that you've used `=` instead of `==`.
ℹ Did you mean `Superficie == 310242.1`?</code></pre>
</div>
</div>
<p>Hay otro problema común que puedes encontrar al usar <code>==</code>: los números de coma flotante. <strong>¡Estos resultados pueden sorprenderte!</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">/</span> <span class="dv">49</span> <span class="sc">*</span> <span class="dv">49</span> <span class="sc">==</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Las computadoras usan <strong>aritmética de precisión finita</strong> (obviamente, <strong>NO</strong> pueden <strong>almacenar</strong> una <strong>cantidad infinita de dígitos</strong>), así que recuerda que cada número que observas es una aproximación. En lugar de confiar en <strong><code>==</code></strong>, usa <strong><code>near()</code></strong> (cercano, en inglés):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">near</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">near</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">49</span> <span class="sc">*</span> <span class="dv">49</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="operadores-lógicos" class="level4">
<h4 class="anchored" data-anchor-id="operadores-lógicos">Operadores lógicos</h4>
<p>Si tienes múltiples argumentos para <strong><code>filter()</code></strong> estos se combinan con <strong>“y”</strong>: cada expresión debe ser verdadera para que una fila se incluya en el output. Para otros tipos de combinaciones necesitarás usar operadores Booleanos: <strong>&amp; es “y”</strong>, <strong>| es “o”</strong>, y <strong>! es “no”</strong>. La siguiente figura muestra el conjunto completo de operaciones <strong>Booleanas</strong>.</p>
<p align="center">
<img width="500" src="https://es.r4ds.hadley.nz/diagrams_w_text_as_path/es/transform-logical.svg">
</p>
<p>El siguiente código sirve para encontrar todas las areas iguales a <code>310242.10</code> o <code>1880.50</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento,Superficie <span class="sc">==</span> <span class="fl">310242.10</span> <span class="sc">|</span> Superficie <span class="sc">==</span> <span class="fl">1880.50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X Codigo                 Area_natur   Periodo               Base_legal
1  5   RN06 de Salinas y Aguada Blanca 2016-2020  R.J. Nº 087-2007 INRENA
2 52   SN03           Lagunas de Mejía 2015-2019 R.P. Nº 238-2015-SERNANP
  Fecha_lega Base_leg00 Fecha_le00               Base_leg01 Fecha_le01
1 2007-04-26       &lt;NA&gt; 1899-12-30 R.P. N° 257-2016-SERNANP 2016-09-14
2 2015-10-29       &lt;NA&gt; 1899-12-30 R.P. N° 144-2020-SERNANP 2020-09-17
  Superficie
1   310242.1
2     1880.5</code></pre>
</div>
</div>
<p>El orden de las operaciones no funciona como en español. No puedes escribir <strong><code>filter(z_amortiguamiento, Superficie == (310242.10 | 1880.50))</code></strong>, que literalmente puede traducirse como <strong>“encuentra todas las areas de 310242.10 o 1880.50”</strong>. En cambio, encontrará todos los areas que son iguales a <strong>310242.10 | 1880.50</strong>, una expresión que resulta en <strong>‘TRUE’</strong> (verdadero). En un contexto numérico (como aquí), <strong>‘TRUE’ se convierte en uno</strong>, por lo que <strong>encuentra</strong> todos las <strong>areas de 310242.10</strong>, <strong>NO</strong> en <strong>310242.10 o 1880.50</strong>. ¡Esto es bastante confuso!</p>
<p>Una manera rápida y útil para resolver este problema es <strong><code>x %in% y</code></strong> (es decir, x en y). Esto <strong>seleccionará cada fila donde x es uno de los valores en y</strong>. Podríamos usarlo para reescribir el código de arriba:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento, Superficie <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fl">310242.10</span>, <span class="fl">1880.50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X Codigo                 Area_natur   Periodo               Base_legal
1  5   RN06 de Salinas y Aguada Blanca 2016-2020  R.J. Nº 087-2007 INRENA
2 52   SN03           Lagunas de Mejía 2015-2019 R.P. Nº 238-2015-SERNANP
  Fecha_lega Base_leg00 Fecha_le00               Base_leg01 Fecha_le01
1 2007-04-26       &lt;NA&gt; 1899-12-30 R.P. N° 257-2016-SERNANP 2016-09-14
2 2015-10-29       &lt;NA&gt; 1899-12-30 R.P. N° 144-2020-SERNANP 2020-09-17
  Superficie
1   310242.1
2     1880.5</code></pre>
</div>
</div>
<p>A veces puedes simplificar subconjuntos complicados al recordar <strong>la ley de De Morgan</strong>: <strong>!(x &amp; y)</strong> es lo mismo que <strong>!x | !y</strong>, y <strong>!(x | y)</strong> es lo mismo que **!x &amp; !y*. Por ejemplo, si deseas encontrar areas mayores a <code>26.2</code> y menores <code>8652.24</code> .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(z_amortiguamiento,<span class="sc">!</span>(Superficie <span class="sc">&gt;</span> <span class="fl">8652.24</span>  <span class="sc">|</span> Superficie <span class="sc">&lt;</span> <span class="fl">26.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    X Codigo                Area_natur   Periodo               Base_legal
1   9   SH02   de la Pampa de Ayacucho 2016-2020 R.P. N° 019-2016-SERNANP
2  10   SH01             de Chacamarca 2002-2007  R.J. Nº 466-2002-INRENA
3  13   SN04                  de Ampay 2015-2019 R.P. Nº 168-2015-SERNANP
4  14   SN01               de Huayllay 2018-2022  R.J. Nº 325-2001 INRENA
5  21   PN05         Cerros de Amotape 2012-2017 R.P. N° 039-2012-SERNANP
6  36   SN05   los Manglares de Tumbes 2023-2027 R.P. N° 063-2017-SERNANP
7  37   RC05               Machiguenga 2023-2027 R.P. N° 065-2017-SERNANP
8  39   SN07             Pampa Hermosa 2022-2027 R.P. Nº 213-2012-SERNANP
9  40  RVS01                Laquipampa 2015-2019 R.P. Nº 014-2015-SERNANP
10 41  RVS02     Los Pantanos de Villa 2016-2020  R.J. Nº 358-2001-INRENA
11 44   ZR01              Chancaybaños      &lt;NA&gt;  R.J. Nº 337-2001-INRENA
12 46   RC08                Chayu Naín      &lt;NA&gt; R.P. Nº 026-2011-SERNANP
13 47   RC08                Chayu Naín      &lt;NA&gt; R.P. Nº 026-2011-SERNANP
14 48  RVS03 Bosques Nublados de Udima 2015-2019 R.P. Nº 052-2015-SERNANP
15 49  RVS03 Bosques Nublados de Udima 2015-2019 R.P. Nº 052-2015-SERNANP
16 50  RVS03 Bosques Nublados de Udima 2015-2019 R.P. Nº 052-2015-SERNANP
17 52   SN03          Lagunas de Mejía 2015-2019 R.P. Nº 238-2015-SERNANP
18 53   BP05             de Pagaibamba 2017-2021  R.J. Nº 306-2001-INRENA
19 56   PN02            de Tingo María 2022-2026 R.P. N° 090-2017-SERNANP
20 59   RN04                 de Lachay 2019-2023 R.P. Nº 090-2013-SERNANP
21 79   RC10                   Huimeki 2023-2027  R.P N° 080-2023-SERNANP
   Fecha_lega   Base_leg00 Fecha_le00               Base_leg01 Fecha_le01
1  2016-01-29         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
2  2002-12-20         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
3  2014-12-22         &lt;NA&gt; 1899-12-30 R.P. Nº 012-2022-SERNANP 2022-01-13
4  2001-12-13         &lt;NA&gt; 1899-12-30 R.P. N° 268-2018-SERNANP 2018-11-05
5  2012-02-17 Ley N° 30359 2015-11-11                     &lt;NA&gt; 1899-12-30
6  2017-02-28         &lt;NA&gt; 1899-12-30 R.P. N° 064-2023-SERNANP 2023-02-17
7  2017-02-28         &lt;NA&gt; 1899-12-30 R.P. N° 339-2022-SERNANP 2022-12-29
8  2012-12-28         &lt;NA&gt; 1899-12-30 R.P. Nº 184-2022-SERNANP 2022-08-04
9  2015-01-27         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
10 2001-12-28         &lt;NA&gt; 1899-12-30 R.P. N° 169-2016-SERNANP 2016-08-05
11 2001-12-26         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
12 2011-02-18         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
13 2011-02-18         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
14 2015-03-16         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
15 2015-03-16         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
16 2015-03-16         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
17 2015-10-29         &lt;NA&gt; 1899-12-30 R.P. N° 144-2020-SERNANP 2020-09-17
18 2001-12-13         &lt;NA&gt; 1899-12-30 R.P. N° 130-2017-SERNANP 2017-05-22
19 2017-03-31         &lt;NA&gt; 1899-12-30 R.P. Nº 027-2022-SERNANP 2022-01-20
20 2013-05-30         &lt;NA&gt; 1899-12-30 R.P. N° 071-2019-SERNANP 2019-03-10
21 2023-03-01         &lt;NA&gt; 1899-12-30                     &lt;NA&gt; 1899-12-30
   Superficie
1      429.19
2     1332.28
3     5702.07
4     4843.62
5     3492.40
6     5208.08
7     6371.03
8     8652.24
9     4622.00
10    1047.22
11    4045.57
12    8236.84
13    4153.80
14    2994.30
15      26.25
16    1002.71
17    1880.50
18    4100.13
19    4125.72
20    3354.05
21    5499.98</code></pre>
</div>
</div>
</section>
</section>
<section id="reordenar-las-filas-con-arrange" class="level3">
<h3 class="anchored" data-anchor-id="reordenar-las-filas-con-arrange">Reordenar las filas con arrange()</h3>
<p><strong><code>arrange()** funciona de manera similar a</code>filter()` excepto que en lugar de seleccionar filas, cambia su orden. La función toma un </strong>dataframe** y un conjunto de nombres de columnas (o expresiones más complicadas) para ordenar según ellas. Si proporcionas más de un nombre de columna, cada columna adicional se utilizará para romper empates en los valores de las columnas anteriores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(z_amortiguamiento, Codigo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    X Codigo                          Area_natur   Periodo
1   2   BP03                          de Pui Pui 2019-2023
2  75   BP04               San Matias-San Carlos 2023-2027
3  53   BP05                       de Pagaibamba 2017-2021
4  77   BP06                           Alto Mayo 2023-2027
5  57   CC01                           El Angolo 2019-2023
6  29   CC02                         Sunchubamba      &lt;NA&gt;
7  26   PN01                          de Cutervo 2017-2021
8  56   PN02                      de Tingo María 2022-2026
9  24   PN03                            del Manu 2019-2023
10 25   PN03                            del Manu 2019-2023
11 23   PN04                           Huascarán 2017-2021
12 20   PN05                   Cerros de Amotape 2012-2017
13 21   PN05                   Cerros de Amotape 2012-2017
14 22   PN05                   Cerros de Amotape 2012-2017
15 30   PN06                      del Río Abiseo 2014-2019
16 71   PN07                 Yanachaga-Chemillén 2022-2026
17 19   PN08                      Bahuaja-Sonene 2015-2019
18 18   PN09                     Cordillera Azul 2017-2021
19 65   PN10                              Otishi 2016-2020
20 66   PN11                          Alto Purús 2019-2023
21 67   PN11                          Alto Purús 2019-2023
22 68   PN11                          Alto Purús 2019-2023
23 27   PN12 Ichigkat Muja-Cordillera del Cóndor 2019-2023
24 15   PN14                  Sierra del Divisor 2023-2027
25 16   PN14                  Sierra del Divisor 2023-2027
26 17   PN14                  Sierra del Divisor 2023-2027
27 70   PN15                              Yaguas 2021-2025
28 76   RC01                             Yanesha 2017-2021
29 51   RC02                             El Sira 2015-2019
30 34   RC03                          Amarakaeri 2016-2020
31  1   RC04                           Ashaninka 2019-2023
32 35   RC05                         Machiguenga 2023-2027
33 37   RC05                         Machiguenga 2023-2027
34 38   RC05                         Machiguenga 2023-2027
35 58   RC06                               Purús 2019-2023
36 45   RC07                           Tuntanain 2016-2020
37 46   RC08                          Chayu Naín      &lt;NA&gt;
38 47   RC08                          Chayu Naín      &lt;NA&gt;
39 74   RC09                            Airo Pai 2022-2026
40 79   RC10                             Huimeki 2023-2027
41 80   RC10                             Huimeki 2023-2027
42  7   RN01    Pampa Galeras Barbara D' Achille 2022-2026
43  6   RN02                            de Junín 2008-2012
44 43   RN03                          de Paracas 2016-2020
45 59   RN04                           de Lachay 2019-2023
46 69   RN05                        del Titicaca 2021-2025
47  5   RN06          de Salinas y Aguada Blanca 2016-2020
48 54   RN07                          de Calipuy 2015-2019
49 42   RN08                      Pacaya-Samiria 2017-2021
50 62   RN09                           Tambopata 2019-2023
51 63   RN09                           Tambopata 2019-2023
52 64   RN09                           Tambopata 2019-2023
53  4   RN10                  Allpahuayo Mishana 2022-2026
54  3   RN12                              Matsés 2023-2027
55 28   RN14                            Pucacuro 2019-2023
56 61   RN15                        San Fernando 2019-2024
57 78   RP01                   Nor Yauyos-Cochas 2022-2027
58 60   RP02             Subcuenca del Cotahuasi 2019-2023
59 40  RVS01                          Laquipampa 2015-2019
60 41  RVS02               Los Pantanos de Villa 2016-2020
61 48  RVS03           Bosques Nublados de Udima 2015-2019
62 49  RVS03           Bosques Nublados de Udima 2015-2019
63 50  RVS03           Bosques Nublados de Udima 2015-2019
64 10   SH01                       de Chacamarca 2002-2007
65  9   SH02             de la Pampa de Ayacucho 2016-2020
66 33   SH03                         Machupicchu 2015-2019
67  8   SH04                     Bosque de Pomac 2017-2021
68 14   SN01                         de Huayllay 2018-2022
69 55   SN02                          de Calipuy 2015-2019
70 52   SN03                    Lagunas de Mejía 2015-2019
71 13   SN04                            de Ampay 2015-2019
72 36   SN05             los Manglares de Tumbes 2023-2027
73 72   SN06                           Megantoni 2022-2026
74 73   SN06                           Megantoni 2022-2026
75 39   SN07                       Pampa Hermosa 2022-2027
76 12   SN08                  Tabaconas-Namballe 2023-2027
77 11   SN09                 Cordillera de Colán 2016-2020
78 44   ZR01                        Chancaybaños      &lt;NA&gt;
79 31   ZR03                    Santiago Comaina      &lt;NA&gt;
80 32   ZR03                    Santiago Comaina      &lt;NA&gt;
                   Base_legal Fecha_lega               Base_leg00 Fecha_le00
1     R.J. Nº 285-2008 INRENA 2008-10-28                     &lt;NA&gt; 1899-12-30
2    R.P. N° 268-2015-SERNANP 2015-11-27                     &lt;NA&gt; 1899-12-30
3     R.J. Nº 306-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
4    R.P. Nº 069-2023-SERNANP 2023-02-27                     &lt;NA&gt; 1899-12-30
5    R.P. N° 212-2012-SERNANP 2012-11-28                     &lt;NA&gt; 1899-12-30
6     R.J. Nº 303-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
7    R.P. Nº 175-2009-SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
8    R.P. N° 090-2017-SERNANP 2017-03-31                     &lt;NA&gt; 1899-12-30
9    R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
10   R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
11   R.P. Nº 241-2010-SERNANP 2010-12-30                     &lt;NA&gt; 1899-12-30
12   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
13   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
14   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
15   R.J. Nº 253 -2006 INRENA 2006-09-27                     &lt;NA&gt; 1899-12-30
16   R.P. N° 011-2022-SERNANP 2022-01-13                     &lt;NA&gt; 1899-12-30
17   R.P. Nº 111-2015-SERNANP 2015-06-10                     &lt;NA&gt; 1899-12-30
18   R.P. Nº 064-2011-SERNANP 2011-04-14                     &lt;NA&gt; 1899-12-30
19   R.P. N° 290-2016-SERNANP 2016-10-31                     &lt;NA&gt; 1899-12-30
20   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
21   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
22   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
23    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
24   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
25   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
26   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
27   R.P. Nº 085-2021-SERNANP 2021-04-23                     &lt;NA&gt; 1899-12-30
28   R.J. Nº 129-2011-SERNANP 2011-07-01                     &lt;NA&gt; 1899-12-30
29   R.P. Nº 044-2009 SERNANP 2009-02-27                     &lt;NA&gt; 1899-12-30
30   R.P. N° 198-2016-SERNANP 2016-07-26                     &lt;NA&gt; 1899-12-30
31   R.P. Nº 239-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
32   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
33   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
34   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
35   R.P. Nº 003-2013-SERNANP 1899-12-30                     &lt;NA&gt; 1899-12-30
36    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
37   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
38   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
39   R.P. N° 058-2022-SERNANP 2022-02-16                     &lt;NA&gt; 1899-12-30
40    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
41    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
42    R.J. Nº 331-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
43    R.J. Nº 145-2008 INRENA 2008-06-03                     &lt;NA&gt; 1899-12-30
44   R.P. Nº 020-2016 SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
45   R.P. Nº 090-2013-SERNANP 2013-05-30                     &lt;NA&gt; 1899-12-30
46   R.P. N° 038-2021-SERNANP 2021-02-12                     &lt;NA&gt; 1899-12-30
47    R.J. Nº 087-2007 INRENA 2007-04-26                     &lt;NA&gt; 1899-12-30
48   R.P. Nº 032-2015-SERNANP 2015-02-18                     &lt;NA&gt; 1899-12-30
49   R.J. Nº 173-2009 SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
50    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
51    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
52    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
53    R.J. Nº 159-2007 INRENA 2007-07-24                     &lt;NA&gt; 1899-12-30
54 R.P. Nº 054-2014-SERNANP-J 2014-02-27                     &lt;NA&gt; 1899-12-30
55   R.P. Nº 047-2013-SERNANP 2013-03-20                     &lt;NA&gt; 1899-12-30
56   R.P. Nº 118-2015-SERNANP 2015-06-19                     &lt;NA&gt; 1899-12-30
57    R.J. Nº 194-2006 INRENA 2006-07-20                     &lt;NA&gt; 1899-12-30
58   R.P. Nº 163-2009 SERNANP 2009-09-15                     &lt;NA&gt; 1899-12-30
59   R.P. Nº 014-2015-SERNANP 2015-01-27                     &lt;NA&gt; 1899-12-30
60    R.J. Nº 358-2001-INRENA 2001-12-28                     &lt;NA&gt; 1899-12-30
61   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
62   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
63   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
64    R.J. Nº 466-2002-INRENA 2002-12-20                     &lt;NA&gt; 1899-12-30
65   R.P. N° 019-2016-SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
66   R.P. Nº 070-2015-SERNANP 2015-04-17                     &lt;NA&gt; 1899-12-30
67   R.P. Nº 006-2011-SERNANP 2011-01-19                     &lt;NA&gt; 1899-12-30
68    R.J. Nº 325-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
69   R.P. Nº 021-2015-SERNANP 2015-02-10                     &lt;NA&gt; 1899-12-30
70   R.P. Nº 238-2015-SERNANP 2015-10-29                     &lt;NA&gt; 1899-12-30
71   R.P. Nº 168-2015-SERNANP 2014-12-22                     &lt;NA&gt; 1899-12-30
72   R.P. N° 063-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
73   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
74   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
75   R.P. Nº 213-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
76    R.J. Nº 015-2007 INRENA 2007-01-22                     &lt;NA&gt; 1899-12-30
77   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
78    R.J. Nº 337-2001-INRENA 2001-12-26                     &lt;NA&gt; 1899-12-30
79    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
80    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
                   Base_leg01 Fecha_le01 Superficie
1    R.P. N° 033-2019-SERNANP 2019-01-29   45367.20
2    R.P. N° 332-2022-SERNANP 2022-12-29  128479.57
3    R.P. N° 130-2017-SERNANP 2017-05-22    4100.13
4                        &lt;NA&gt; 1899-12-30  222953.88
5    R.P. N° 336-2018-SERNANP 2018-12-31   29583.14
6                        &lt;NA&gt; 1899-12-30   28404.36
7    R.P. N° 031-2017-SERNANP 2017-01-31   19009.20
8    R.P. Nº 027-2022-SERNANP 2022-01-20    4125.72
9    R.P. N° 337-2018-SERNANP 2018-12-31  392819.65
10   R.P. N° 337-2018-SERNANP 2018-12-31  273370.45
11    R.P. N° 64-2017-SERNANP 2017-02-28  178434.11
12                       &lt;NA&gt; 1899-12-30   66699.00
13                       &lt;NA&gt; 1899-12-30    3492.40
14                       &lt;NA&gt; 1899-12-30   21614.02
15    R.P. N° 73-2014-SERNANP 2014-03-25  671363.75
16                       &lt;NA&gt; 1899-12-30   60785.61
17                       &lt;NA&gt; 1899-12-30  261127.28
18   R.P. N° 032-2017-SERNANP 2017-01-31 2304596.68
19                       &lt;NA&gt; 1899-12-30   38887.63
20   R.P. N° 087-2019-SERNANP 2019-04-04  632382.65
21   R.P. N° 087-2019-SERNANP 2019-04-04  867663.35
22   R.P. N° 087-2019-SERNANP 2019-04-04  202033.34
23   R.P. N° 338-2018-SERNANP 2018-12-31  138965.15
24   R.P. N° 043-2023-SERNANP 2023-02-01  362286.24
25   R.P. N° 043-2023-SERNANP 2023-02-01  260177.68
26   R.P. N° 043-2023-SERNANP 2023-02-01    9106.53
27                       &lt;NA&gt; 1899-12-30  241073.13
28   R.P. N° 346-2016-SERNANP 2016-12-29   51379.07
29   R.P. N° 134-2015-SERNANP 2015-07-09 1095646.64
30                       &lt;NA&gt; 1899-12-30  283545.59
31   R.P. N° 034-2019-SERNANP 2019-01-29  325684.03
32   R.P. N° 339-2022-SERNANP 2022-12-29  316383.50
33   R.P. N° 339-2022-SERNANP 2022-12-29    6371.03
34   R.P. N° 339-2022-SERNANP 2022-12-29  197205.13
35   R.P. N° 062-2019-SERNANP 2019-02-25  222423.17
36   R.P. N° 139-2016-SERNANP 2016-06-06  288188.56
37                       &lt;NA&gt; 1899-12-30    8236.84
38                       &lt;NA&gt; 1899-12-30    4153.80
39                       &lt;NA&gt; 1899-12-30   62423.85
40                       &lt;NA&gt; 1899-12-30    5499.98
41                       &lt;NA&gt; 1899-12-30   16655.73
42 R.P. N° 069-2022-SERNANP\n 2022-03-02   14530.51
43                       &lt;NA&gt; 1899-12-30  100858.12
44                       &lt;NA&gt; 1899-12-30  140885.51
45   R.P. N° 071-2019-SERNANP 2019-03-10    3354.05
46                       &lt;NA&gt; 1899-12-30  164565.27
47   R.P. N° 257-2016-SERNANP 2016-09-14  310242.10
48                       &lt;NA&gt; 1899-12-30   36660.57
49   R.P. N° 273-2017-SERNANP 2017-11-30 1219807.51
50   R.P. N° 035-2019-SERNANP 2019-01-29   15650.38
51   R.P. N° 035-2019-SERNANP 2019-01-29   22027.06
52   R.P. N° 035-2019-SERNANP 2019-01-29  193877.91
53   R.P. N° 082-2022-SERNANP 2022-03-15   65956.53
54    R.P N° 320-2022-SERNANP 2022-12-29  231397.76
55   R.P. N° 339-2018-SERNANP 2018-12-31  339499.85
56   R.P. Nº 239-2019-SERNANP 2019-10-11   73256.14
57   R.P. N° 264-2022-SERNANP 2022-11-15  109438.36
58   R.P. N° 079-2019-SERNANP 2019-03-14  485112.73
59                       &lt;NA&gt; 1899-12-30    4622.00
60   R.P. N° 169-2016-SERNANP 2016-08-05    1047.22
61                       &lt;NA&gt; 1899-12-30    2994.30
62                       &lt;NA&gt; 1899-12-30      26.25
63                       &lt;NA&gt; 1899-12-30    1002.71
64                       &lt;NA&gt; 1899-12-30    1332.28
65                       &lt;NA&gt; 1899-12-30     429.19
66                       &lt;NA&gt; 1899-12-30  133083.09
67    R.P. N° 91-2017-SERNANP 2017-03-31    9291.39
68   R.P. N° 268-2018-SERNANP 2018-11-05    4843.62
69                       &lt;NA&gt; 1899-12-30   10506.92
70   R.P. N° 144-2020-SERNANP 2020-09-17    1880.50
71   R.P. Nº 012-2022-SERNANP 2022-01-13    5702.07
72   R.P. N° 064-2023-SERNANP 2023-02-17    5208.08
73                       &lt;NA&gt; 1899-12-30  128192.77
74                       &lt;NA&gt; 1899-12-30   77891.55
75   R.P. Nº 184-2022-SERNANP 2022-08-04    8652.24
76   R.P. N° 338-2022-SERNANP 2022-12-29   44993.90
77   R.P. N° 140-2016-SERNANP 2016-06-06   18866.71
78                       &lt;NA&gt; 1899-12-30    4045.57
79                       &lt;NA&gt; 1899-12-30  117141.77
80                       &lt;NA&gt; 1899-12-30   87651.54</code></pre>
</div>
</div>
<p>Usa <strong><code>desc()</code></strong> para reordenar por una columna en orden descendente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(z_amortiguamiento, <span class="fu">desc</span>(Superficie))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    X Codigo                          Area_natur   Periodo
1  18   PN09                     Cordillera Azul 2017-2021
2  42   RN08                      Pacaya-Samiria 2017-2021
3  51   RC02                             El Sira 2015-2019
4  67   PN11                          Alto Purús 2019-2023
5  30   PN06                      del Río Abiseo 2014-2019
6  66   PN11                          Alto Purús 2019-2023
7  60   RP02             Subcuenca del Cotahuasi 2019-2023
8  24   PN03                            del Manu 2019-2023
9  15   PN14                  Sierra del Divisor 2023-2027
10 28   RN14                            Pucacuro 2019-2023
11  1   RC04                           Ashaninka 2019-2023
12 35   RC05                         Machiguenga 2023-2027
13  5   RN06          de Salinas y Aguada Blanca 2016-2020
14 45   RC07                           Tuntanain 2016-2020
15 34   RC03                          Amarakaeri 2016-2020
16 25   PN03                            del Manu 2019-2023
17 19   PN08                      Bahuaja-Sonene 2015-2019
18 16   PN14                  Sierra del Divisor 2023-2027
19 70   PN15                              Yaguas 2021-2025
20  3   RN12                              Matsés 2023-2027
21 77   BP06                           Alto Mayo 2023-2027
22 58   RC06                               Purús 2019-2023
23 68   PN11                          Alto Purús 2019-2023
24 38   RC05                         Machiguenga 2023-2027
25 64   RN09                           Tambopata 2019-2023
26 23   PN04                           Huascarán 2017-2021
27 69   RN05                        del Titicaca 2021-2025
28 43   RN03                          de Paracas 2016-2020
29 27   PN12 Ichigkat Muja-Cordillera del Cóndor 2019-2023
30 33   SH03                         Machupicchu 2015-2019
31 75   BP04               San Matias-San Carlos 2023-2027
32 72   SN06                           Megantoni 2022-2026
33 31   ZR03                    Santiago Comaina      &lt;NA&gt;
34 78   RP01                   Nor Yauyos-Cochas 2022-2027
35  6   RN02                            de Junín 2008-2012
36 32   ZR03                    Santiago Comaina      &lt;NA&gt;
37 73   SN06                           Megantoni 2022-2026
38 61   RN15                        San Fernando 2019-2024
39 20   PN05                   Cerros de Amotape 2012-2017
40  4   RN10                  Allpahuayo Mishana 2022-2026
41 74   RC09                            Airo Pai 2022-2026
42 71   PN07                 Yanachaga-Chemillén 2022-2026
43 76   RC01                             Yanesha 2017-2021
44  2   BP03                          de Pui Pui 2019-2023
45 12   SN08                  Tabaconas-Namballe 2023-2027
46 65   PN10                              Otishi 2016-2020
47 54   RN07                          de Calipuy 2015-2019
48 57   CC01                           El Angolo 2019-2023
49 29   CC02                         Sunchubamba      &lt;NA&gt;
50 63   RN09                           Tambopata 2019-2023
51 22   PN05                   Cerros de Amotape 2012-2017
52 26   PN01                          de Cutervo 2017-2021
53 11   SN09                 Cordillera de Colán 2016-2020
54 80   RC10                             Huimeki 2023-2027
55 62   RN09                           Tambopata 2019-2023
56  7   RN01    Pampa Galeras Barbara D' Achille 2022-2026
57 55   SN02                          de Calipuy 2015-2019
58  8   SH04                     Bosque de Pomac 2017-2021
59 17   PN14                  Sierra del Divisor 2023-2027
60 39   SN07                       Pampa Hermosa 2022-2027
61 46   RC08                          Chayu Naín      &lt;NA&gt;
62 37   RC05                         Machiguenga 2023-2027
63 13   SN04                            de Ampay 2015-2019
64 79   RC10                             Huimeki 2023-2027
65 36   SN05             los Manglares de Tumbes 2023-2027
66 14   SN01                         de Huayllay 2018-2022
67 40  RVS01                          Laquipampa 2015-2019
68 47   RC08                          Chayu Naín      &lt;NA&gt;
69 56   PN02                      de Tingo María 2022-2026
70 53   BP05                       de Pagaibamba 2017-2021
71 44   ZR01                        Chancaybaños      &lt;NA&gt;
72 21   PN05                   Cerros de Amotape 2012-2017
73 59   RN04                           de Lachay 2019-2023
74 48  RVS03           Bosques Nublados de Udima 2015-2019
75 52   SN03                    Lagunas de Mejía 2015-2019
76 10   SH01                       de Chacamarca 2002-2007
77 41  RVS02               Los Pantanos de Villa 2016-2020
78 50  RVS03           Bosques Nublados de Udima 2015-2019
79  9   SH02             de la Pampa de Ayacucho 2016-2020
80 49  RVS03           Bosques Nublados de Udima 2015-2019
                   Base_legal Fecha_lega               Base_leg00 Fecha_le00
1    R.P. Nº 064-2011-SERNANP 2011-04-14                     &lt;NA&gt; 1899-12-30
2    R.J. Nº 173-2009 SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
3    R.P. Nº 044-2009 SERNANP 2009-02-27                     &lt;NA&gt; 1899-12-30
4    R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
5    R.J. Nº 253 -2006 INRENA 2006-09-27                     &lt;NA&gt; 1899-12-30
6    R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
7    R.P. Nº 163-2009 SERNANP 2009-09-15                     &lt;NA&gt; 1899-12-30
8    R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
9    R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
10   R.P. Nº 047-2013-SERNANP 2013-03-20                     &lt;NA&gt; 1899-12-30
11   R.P. Nº 239-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
12   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
13    R.J. Nº 087-2007 INRENA 2007-04-26                     &lt;NA&gt; 1899-12-30
14    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
15   R.P. N° 198-2016-SERNANP 2016-07-26                     &lt;NA&gt; 1899-12-30
16   R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
17   R.P. Nº 111-2015-SERNANP 2015-06-10                     &lt;NA&gt; 1899-12-30
18   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
19   R.P. Nº 085-2021-SERNANP 2021-04-23                     &lt;NA&gt; 1899-12-30
20 R.P. Nº 054-2014-SERNANP-J 2014-02-27                     &lt;NA&gt; 1899-12-30
21   R.P. Nº 069-2023-SERNANP 2023-02-27                     &lt;NA&gt; 1899-12-30
22   R.P. Nº 003-2013-SERNANP 1899-12-30                     &lt;NA&gt; 1899-12-30
23   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
24   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
25    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
26   R.P. Nº 241-2010-SERNANP 2010-12-30                     &lt;NA&gt; 1899-12-30
27   R.P. N° 038-2021-SERNANP 2021-02-12                     &lt;NA&gt; 1899-12-30
28   R.P. Nº 020-2016 SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
29    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
30   R.P. Nº 070-2015-SERNANP 2015-04-17                     &lt;NA&gt; 1899-12-30
31   R.P. N° 268-2015-SERNANP 2015-11-27                     &lt;NA&gt; 1899-12-30
32   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
33    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
34    R.J. Nº 194-2006 INRENA 2006-07-20                     &lt;NA&gt; 1899-12-30
35    R.J. Nº 145-2008 INRENA 2008-06-03                     &lt;NA&gt; 1899-12-30
36    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
37   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
38   R.P. Nº 118-2015-SERNANP 2015-06-19                     &lt;NA&gt; 1899-12-30
39   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
40    R.J. Nº 159-2007 INRENA 2007-07-24                     &lt;NA&gt; 1899-12-30
41   R.P. N° 058-2022-SERNANP 2022-02-16                     &lt;NA&gt; 1899-12-30
42   R.P. N° 011-2022-SERNANP 2022-01-13                     &lt;NA&gt; 1899-12-30
43   R.J. Nº 129-2011-SERNANP 2011-07-01                     &lt;NA&gt; 1899-12-30
44    R.J. Nº 285-2008 INRENA 2008-10-28                     &lt;NA&gt; 1899-12-30
45    R.J. Nº 015-2007 INRENA 2007-01-22                     &lt;NA&gt; 1899-12-30
46   R.P. N° 290-2016-SERNANP 2016-10-31                     &lt;NA&gt; 1899-12-30
47   R.P. Nº 032-2015-SERNANP 2015-02-18                     &lt;NA&gt; 1899-12-30
48   R.P. N° 212-2012-SERNANP 2012-11-28                     &lt;NA&gt; 1899-12-30
49    R.J. Nº 303-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
50    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
51   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
52   R.P. Nº 175-2009-SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
53   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
54    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
55    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
56    R.J. Nº 331-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
57   R.P. Nº 021-2015-SERNANP 2015-02-10                     &lt;NA&gt; 1899-12-30
58   R.P. Nº 006-2011-SERNANP 2011-01-19                     &lt;NA&gt; 1899-12-30
59   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
60   R.P. Nº 213-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
61   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
62   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
63   R.P. Nº 168-2015-SERNANP 2014-12-22                     &lt;NA&gt; 1899-12-30
64    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
65   R.P. N° 063-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
66    R.J. Nº 325-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
67   R.P. Nº 014-2015-SERNANP 2015-01-27                     &lt;NA&gt; 1899-12-30
68   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
69   R.P. N° 090-2017-SERNANP 2017-03-31                     &lt;NA&gt; 1899-12-30
70    R.J. Nº 306-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
71    R.J. Nº 337-2001-INRENA 2001-12-26                     &lt;NA&gt; 1899-12-30
72   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
73   R.P. Nº 090-2013-SERNANP 2013-05-30                     &lt;NA&gt; 1899-12-30
74   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
75   R.P. Nº 238-2015-SERNANP 2015-10-29                     &lt;NA&gt; 1899-12-30
76    R.J. Nº 466-2002-INRENA 2002-12-20                     &lt;NA&gt; 1899-12-30
77    R.J. Nº 358-2001-INRENA 2001-12-28                     &lt;NA&gt; 1899-12-30
78   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
79   R.P. N° 019-2016-SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
80   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
                   Base_leg01 Fecha_le01 Superficie
1    R.P. N° 032-2017-SERNANP 2017-01-31 2304596.68
2    R.P. N° 273-2017-SERNANP 2017-11-30 1219807.51
3    R.P. N° 134-2015-SERNANP 2015-07-09 1095646.64
4    R.P. N° 087-2019-SERNANP 2019-04-04  867663.35
5     R.P. N° 73-2014-SERNANP 2014-03-25  671363.75
6    R.P. N° 087-2019-SERNANP 2019-04-04  632382.65
7    R.P. N° 079-2019-SERNANP 2019-03-14  485112.73
8    R.P. N° 337-2018-SERNANP 2018-12-31  392819.65
9    R.P. N° 043-2023-SERNANP 2023-02-01  362286.24
10   R.P. N° 339-2018-SERNANP 2018-12-31  339499.85
11   R.P. N° 034-2019-SERNANP 2019-01-29  325684.03
12   R.P. N° 339-2022-SERNANP 2022-12-29  316383.50
13   R.P. N° 257-2016-SERNANP 2016-09-14  310242.10
14   R.P. N° 139-2016-SERNANP 2016-06-06  288188.56
15                       &lt;NA&gt; 1899-12-30  283545.59
16   R.P. N° 337-2018-SERNANP 2018-12-31  273370.45
17                       &lt;NA&gt; 1899-12-30  261127.28
18   R.P. N° 043-2023-SERNANP 2023-02-01  260177.68
19                       &lt;NA&gt; 1899-12-30  241073.13
20    R.P N° 320-2022-SERNANP 2022-12-29  231397.76
21                       &lt;NA&gt; 1899-12-30  222953.88
22   R.P. N° 062-2019-SERNANP 2019-02-25  222423.17
23   R.P. N° 087-2019-SERNANP 2019-04-04  202033.34
24   R.P. N° 339-2022-SERNANP 2022-12-29  197205.13
25   R.P. N° 035-2019-SERNANP 2019-01-29  193877.91
26    R.P. N° 64-2017-SERNANP 2017-02-28  178434.11
27                       &lt;NA&gt; 1899-12-30  164565.27
28                       &lt;NA&gt; 1899-12-30  140885.51
29   R.P. N° 338-2018-SERNANP 2018-12-31  138965.15
30                       &lt;NA&gt; 1899-12-30  133083.09
31   R.P. N° 332-2022-SERNANP 2022-12-29  128479.57
32                       &lt;NA&gt; 1899-12-30  128192.77
33                       &lt;NA&gt; 1899-12-30  117141.77
34   R.P. N° 264-2022-SERNANP 2022-11-15  109438.36
35                       &lt;NA&gt; 1899-12-30  100858.12
36                       &lt;NA&gt; 1899-12-30   87651.54
37                       &lt;NA&gt; 1899-12-30   77891.55
38   R.P. Nº 239-2019-SERNANP 2019-10-11   73256.14
39                       &lt;NA&gt; 1899-12-30   66699.00
40   R.P. N° 082-2022-SERNANP 2022-03-15   65956.53
41                       &lt;NA&gt; 1899-12-30   62423.85
42                       &lt;NA&gt; 1899-12-30   60785.61
43   R.P. N° 346-2016-SERNANP 2016-12-29   51379.07
44   R.P. N° 033-2019-SERNANP 2019-01-29   45367.20
45   R.P. N° 338-2022-SERNANP 2022-12-29   44993.90
46                       &lt;NA&gt; 1899-12-30   38887.63
47                       &lt;NA&gt; 1899-12-30   36660.57
48   R.P. N° 336-2018-SERNANP 2018-12-31   29583.14
49                       &lt;NA&gt; 1899-12-30   28404.36
50   R.P. N° 035-2019-SERNANP 2019-01-29   22027.06
51                       &lt;NA&gt; 1899-12-30   21614.02
52   R.P. N° 031-2017-SERNANP 2017-01-31   19009.20
53   R.P. N° 140-2016-SERNANP 2016-06-06   18866.71
54                       &lt;NA&gt; 1899-12-30   16655.73
55   R.P. N° 035-2019-SERNANP 2019-01-29   15650.38
56 R.P. N° 069-2022-SERNANP\n 2022-03-02   14530.51
57                       &lt;NA&gt; 1899-12-30   10506.92
58    R.P. N° 91-2017-SERNANP 2017-03-31    9291.39
59   R.P. N° 043-2023-SERNANP 2023-02-01    9106.53
60   R.P. Nº 184-2022-SERNANP 2022-08-04    8652.24
61                       &lt;NA&gt; 1899-12-30    8236.84
62   R.P. N° 339-2022-SERNANP 2022-12-29    6371.03
63   R.P. Nº 012-2022-SERNANP 2022-01-13    5702.07
64                       &lt;NA&gt; 1899-12-30    5499.98
65   R.P. N° 064-2023-SERNANP 2023-02-17    5208.08
66   R.P. N° 268-2018-SERNANP 2018-11-05    4843.62
67                       &lt;NA&gt; 1899-12-30    4622.00
68                       &lt;NA&gt; 1899-12-30    4153.80
69   R.P. Nº 027-2022-SERNANP 2022-01-20    4125.72
70   R.P. N° 130-2017-SERNANP 2017-05-22    4100.13
71                       &lt;NA&gt; 1899-12-30    4045.57
72                       &lt;NA&gt; 1899-12-30    3492.40
73   R.P. N° 071-2019-SERNANP 2019-03-10    3354.05
74                       &lt;NA&gt; 1899-12-30    2994.30
75   R.P. N° 144-2020-SERNANP 2020-09-17    1880.50
76                       &lt;NA&gt; 1899-12-30    1332.28
77   R.P. N° 169-2016-SERNANP 2016-08-05    1047.22
78                       &lt;NA&gt; 1899-12-30    1002.71
79                       &lt;NA&gt; 1899-12-30     429.19
80                       &lt;NA&gt; 1899-12-30      26.25</code></pre>
</div>
</div>
</section>
<section id="seleccionar-columnas-con-select" class="level3">
<h3 class="anchored" data-anchor-id="seleccionar-columnas-con-select">Seleccionar columnas con select()</h3>
<p align="center">
<img width="500" src="fig/select.png">
</p>
<p>No es raro obtener conjuntos de datos con cientos o incluso miles de variables. En este caso, el primer desafío a menudo se reduce a las variables que realmente te interesan. <code>select()</code> te permite seleccionar rápidamente un subconjunto útil utilizando operaciones basadas en los nombres de las variables.</p>
<p><code>select()</code> no es muy útil con los datos de los vuelos porque solo tenemos 19 variables, pero de todos modos se entiende la idea general:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar columnas por nombre</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(z_amortiguamiento, Codigo, Area_natur)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Codigo                          Area_natur
1    RC04                           Ashaninka
2    BP03                          de Pui Pui
3    RN12                              Matsés
4    RN10                  Allpahuayo Mishana
5    RN06          de Salinas y Aguada Blanca
6    RN02                            de Junín
7    RN01    Pampa Galeras Barbara D' Achille
8    SH04                     Bosque de Pomac
9    SH02             de la Pampa de Ayacucho
10   SH01                       de Chacamarca
11   SN09                 Cordillera de Colán
12   SN08                  Tabaconas-Namballe
13   SN04                            de Ampay
14   SN01                         de Huayllay
15   PN14                  Sierra del Divisor
16   PN14                  Sierra del Divisor
17   PN14                  Sierra del Divisor
18   PN09                     Cordillera Azul
19   PN08                      Bahuaja-Sonene
20   PN05                   Cerros de Amotape
21   PN05                   Cerros de Amotape
22   PN05                   Cerros de Amotape
23   PN04                           Huascarán
24   PN03                            del Manu
25   PN03                            del Manu
26   PN01                          de Cutervo
27   PN12 Ichigkat Muja-Cordillera del Cóndor
28   RN14                            Pucacuro
29   CC02                         Sunchubamba
30   PN06                      del Río Abiseo
31   ZR03                    Santiago Comaina
32   ZR03                    Santiago Comaina
33   SH03                         Machupicchu
34   RC03                          Amarakaeri
35   RC05                         Machiguenga
36   SN05             los Manglares de Tumbes
37   RC05                         Machiguenga
38   RC05                         Machiguenga
39   SN07                       Pampa Hermosa
40  RVS01                          Laquipampa
41  RVS02               Los Pantanos de Villa
42   RN08                      Pacaya-Samiria
43   RN03                          de Paracas
44   ZR01                        Chancaybaños
45   RC07                           Tuntanain
46   RC08                          Chayu Naín
47   RC08                          Chayu Naín
48  RVS03           Bosques Nublados de Udima
49  RVS03           Bosques Nublados de Udima
50  RVS03           Bosques Nublados de Udima
51   RC02                             El Sira
52   SN03                    Lagunas de Mejía
53   BP05                       de Pagaibamba
54   RN07                          de Calipuy
55   SN02                          de Calipuy
56   PN02                      de Tingo María
57   CC01                           El Angolo
58   RC06                               Purús
59   RN04                           de Lachay
60   RP02             Subcuenca del Cotahuasi
61   RN15                        San Fernando
62   RN09                           Tambopata
63   RN09                           Tambopata
64   RN09                           Tambopata
65   PN10                              Otishi
66   PN11                          Alto Purús
67   PN11                          Alto Purús
68   PN11                          Alto Purús
69   RN05                        del Titicaca
70   PN15                              Yaguas
71   PN07                 Yanachaga-Chemillén
72   SN06                           Megantoni
73   SN06                           Megantoni
74   RC09                            Airo Pai
75   BP04               San Matias-San Carlos
76   RC01                             Yanesha
77   BP06                           Alto Mayo
78   RP01                   Nor Yauyos-Cochas
79   RC10                             Huimeki
80   RC10                             Huimeki</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar todas las columnas entre anio y dia (incluyente)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(z_amortiguamiento, Codigo<span class="sc">:</span>Periodo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Codigo                          Area_natur   Periodo
1    RC04                           Ashaninka 2019-2023
2    BP03                          de Pui Pui 2019-2023
3    RN12                              Matsés 2023-2027
4    RN10                  Allpahuayo Mishana 2022-2026
5    RN06          de Salinas y Aguada Blanca 2016-2020
6    RN02                            de Junín 2008-2012
7    RN01    Pampa Galeras Barbara D' Achille 2022-2026
8    SH04                     Bosque de Pomac 2017-2021
9    SH02             de la Pampa de Ayacucho 2016-2020
10   SH01                       de Chacamarca 2002-2007
11   SN09                 Cordillera de Colán 2016-2020
12   SN08                  Tabaconas-Namballe 2023-2027
13   SN04                            de Ampay 2015-2019
14   SN01                         de Huayllay 2018-2022
15   PN14                  Sierra del Divisor 2023-2027
16   PN14                  Sierra del Divisor 2023-2027
17   PN14                  Sierra del Divisor 2023-2027
18   PN09                     Cordillera Azul 2017-2021
19   PN08                      Bahuaja-Sonene 2015-2019
20   PN05                   Cerros de Amotape 2012-2017
21   PN05                   Cerros de Amotape 2012-2017
22   PN05                   Cerros de Amotape 2012-2017
23   PN04                           Huascarán 2017-2021
24   PN03                            del Manu 2019-2023
25   PN03                            del Manu 2019-2023
26   PN01                          de Cutervo 2017-2021
27   PN12 Ichigkat Muja-Cordillera del Cóndor 2019-2023
28   RN14                            Pucacuro 2019-2023
29   CC02                         Sunchubamba      &lt;NA&gt;
30   PN06                      del Río Abiseo 2014-2019
31   ZR03                    Santiago Comaina      &lt;NA&gt;
32   ZR03                    Santiago Comaina      &lt;NA&gt;
33   SH03                         Machupicchu 2015-2019
34   RC03                          Amarakaeri 2016-2020
35   RC05                         Machiguenga 2023-2027
36   SN05             los Manglares de Tumbes 2023-2027
37   RC05                         Machiguenga 2023-2027
38   RC05                         Machiguenga 2023-2027
39   SN07                       Pampa Hermosa 2022-2027
40  RVS01                          Laquipampa 2015-2019
41  RVS02               Los Pantanos de Villa 2016-2020
42   RN08                      Pacaya-Samiria 2017-2021
43   RN03                          de Paracas 2016-2020
44   ZR01                        Chancaybaños      &lt;NA&gt;
45   RC07                           Tuntanain 2016-2020
46   RC08                          Chayu Naín      &lt;NA&gt;
47   RC08                          Chayu Naín      &lt;NA&gt;
48  RVS03           Bosques Nublados de Udima 2015-2019
49  RVS03           Bosques Nublados de Udima 2015-2019
50  RVS03           Bosques Nublados de Udima 2015-2019
51   RC02                             El Sira 2015-2019
52   SN03                    Lagunas de Mejía 2015-2019
53   BP05                       de Pagaibamba 2017-2021
54   RN07                          de Calipuy 2015-2019
55   SN02                          de Calipuy 2015-2019
56   PN02                      de Tingo María 2022-2026
57   CC01                           El Angolo 2019-2023
58   RC06                               Purús 2019-2023
59   RN04                           de Lachay 2019-2023
60   RP02             Subcuenca del Cotahuasi 2019-2023
61   RN15                        San Fernando 2019-2024
62   RN09                           Tambopata 2019-2023
63   RN09                           Tambopata 2019-2023
64   RN09                           Tambopata 2019-2023
65   PN10                              Otishi 2016-2020
66   PN11                          Alto Purús 2019-2023
67   PN11                          Alto Purús 2019-2023
68   PN11                          Alto Purús 2019-2023
69   RN05                        del Titicaca 2021-2025
70   PN15                              Yaguas 2021-2025
71   PN07                 Yanachaga-Chemillén 2022-2026
72   SN06                           Megantoni 2022-2026
73   SN06                           Megantoni 2022-2026
74   RC09                            Airo Pai 2022-2026
75   BP04               San Matias-San Carlos 2023-2027
76   RC01                             Yanesha 2017-2021
77   BP06                           Alto Mayo 2023-2027
78   RP01                   Nor Yauyos-Cochas 2022-2027
79   RC10                             Huimeki 2023-2027
80   RC10                             Huimeki 2023-2027</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar todas las columnas excepto aquellas entre anio en dia (incluyente)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(z_amortiguamiento, <span class="sc">-</span>(Codigo<span class="sc">:</span>Periodo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    X                 Base_legal Fecha_lega               Base_leg00 Fecha_le00
1   1   R.P. Nº 239-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
2   2    R.J. Nº 285-2008 INRENA 2008-10-28                     &lt;NA&gt; 1899-12-30
3   3 R.P. Nº 054-2014-SERNANP-J 2014-02-27                     &lt;NA&gt; 1899-12-30
4   4    R.J. Nº 159-2007 INRENA 2007-07-24                     &lt;NA&gt; 1899-12-30
5   5    R.J. Nº 087-2007 INRENA 2007-04-26                     &lt;NA&gt; 1899-12-30
6   6    R.J. Nº 145-2008 INRENA 2008-06-03                     &lt;NA&gt; 1899-12-30
7   7    R.J. Nº 331-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
8   8   R.P. Nº 006-2011-SERNANP 2011-01-19                     &lt;NA&gt; 1899-12-30
9   9   R.P. N° 019-2016-SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
10 10    R.J. Nº 466-2002-INRENA 2002-12-20                     &lt;NA&gt; 1899-12-30
11 11   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
12 12    R.J. Nº 015-2007 INRENA 2007-01-22                     &lt;NA&gt; 1899-12-30
13 13   R.P. Nº 168-2015-SERNANP 2014-12-22                     &lt;NA&gt; 1899-12-30
14 14    R.J. Nº 325-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
15 15   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
16 16   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
17 17   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
18 18   R.P. Nº 064-2011-SERNANP 2011-04-14                     &lt;NA&gt; 1899-12-30
19 19   R.P. Nº 111-2015-SERNANP 2015-06-10                     &lt;NA&gt; 1899-12-30
20 20   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
21 21   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
22 22   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
23 23   R.P. Nº 241-2010-SERNANP 2010-12-30                     &lt;NA&gt; 1899-12-30
24 24   R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
25 25   R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
26 26   R.P. Nº 175-2009-SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
27 27    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
28 28   R.P. Nº 047-2013-SERNANP 2013-03-20                     &lt;NA&gt; 1899-12-30
29 29    R.J. Nº 303-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
30 30   R.J. Nº 253 -2006 INRENA 2006-09-27                     &lt;NA&gt; 1899-12-30
31 31    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
32 32    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
33 33   R.P. Nº 070-2015-SERNANP 2015-04-17                     &lt;NA&gt; 1899-12-30
34 34   R.P. N° 198-2016-SERNANP 2016-07-26                     &lt;NA&gt; 1899-12-30
35 35   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
36 36   R.P. N° 063-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
37 37   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
38 38   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
39 39   R.P. Nº 213-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
40 40   R.P. Nº 014-2015-SERNANP 2015-01-27                     &lt;NA&gt; 1899-12-30
41 41    R.J. Nº 358-2001-INRENA 2001-12-28                     &lt;NA&gt; 1899-12-30
42 42   R.J. Nº 173-2009 SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
43 43   R.P. Nº 020-2016 SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
44 44    R.J. Nº 337-2001-INRENA 2001-12-26                     &lt;NA&gt; 1899-12-30
45 45    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
46 46   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
47 47   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
48 48   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
49 49   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
50 50   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
51 51   R.P. Nº 044-2009 SERNANP 2009-02-27                     &lt;NA&gt; 1899-12-30
52 52   R.P. Nº 238-2015-SERNANP 2015-10-29                     &lt;NA&gt; 1899-12-30
53 53    R.J. Nº 306-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
54 54   R.P. Nº 032-2015-SERNANP 2015-02-18                     &lt;NA&gt; 1899-12-30
55 55   R.P. Nº 021-2015-SERNANP 2015-02-10                     &lt;NA&gt; 1899-12-30
56 56   R.P. N° 090-2017-SERNANP 2017-03-31                     &lt;NA&gt; 1899-12-30
57 57   R.P. N° 212-2012-SERNANP 2012-11-28                     &lt;NA&gt; 1899-12-30
58 58   R.P. Nº 003-2013-SERNANP 1899-12-30                     &lt;NA&gt; 1899-12-30
59 59   R.P. Nº 090-2013-SERNANP 2013-05-30                     &lt;NA&gt; 1899-12-30
60 60   R.P. Nº 163-2009 SERNANP 2009-09-15                     &lt;NA&gt; 1899-12-30
61 61   R.P. Nº 118-2015-SERNANP 2015-06-19                     &lt;NA&gt; 1899-12-30
62 62    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
63 63    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
64 64    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
65 65   R.P. N° 290-2016-SERNANP 2016-10-31                     &lt;NA&gt; 1899-12-30
66 66   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
67 67   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
68 68   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
69 69   R.P. N° 038-2021-SERNANP 2021-02-12                     &lt;NA&gt; 1899-12-30
70 70   R.P. Nº 085-2021-SERNANP 2021-04-23                     &lt;NA&gt; 1899-12-30
71 71   R.P. N° 011-2022-SERNANP 2022-01-13                     &lt;NA&gt; 1899-12-30
72 72   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
73 73   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
74 74   R.P. N° 058-2022-SERNANP 2022-02-16                     &lt;NA&gt; 1899-12-30
75 75   R.P. N° 268-2015-SERNANP 2015-11-27                     &lt;NA&gt; 1899-12-30
76 76   R.J. Nº 129-2011-SERNANP 2011-07-01                     &lt;NA&gt; 1899-12-30
77 77   R.P. Nº 069-2023-SERNANP 2023-02-27                     &lt;NA&gt; 1899-12-30
78 78    R.J. Nº 194-2006 INRENA 2006-07-20                     &lt;NA&gt; 1899-12-30
79 79    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
80 80    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
                   Base_leg01 Fecha_le01 Superficie
1    R.P. N° 034-2019-SERNANP 2019-01-29  325684.03
2    R.P. N° 033-2019-SERNANP 2019-01-29   45367.20
3     R.P N° 320-2022-SERNANP 2022-12-29  231397.76
4    R.P. N° 082-2022-SERNANP 2022-03-15   65956.53
5    R.P. N° 257-2016-SERNANP 2016-09-14  310242.10
6                        &lt;NA&gt; 1899-12-30  100858.12
7  R.P. N° 069-2022-SERNANP\n 2022-03-02   14530.51
8     R.P. N° 91-2017-SERNANP 2017-03-31    9291.39
9                        &lt;NA&gt; 1899-12-30     429.19
10                       &lt;NA&gt; 1899-12-30    1332.28
11   R.P. N° 140-2016-SERNANP 2016-06-06   18866.71
12   R.P. N° 338-2022-SERNANP 2022-12-29   44993.90
13   R.P. Nº 012-2022-SERNANP 2022-01-13    5702.07
14   R.P. N° 268-2018-SERNANP 2018-11-05    4843.62
15   R.P. N° 043-2023-SERNANP 2023-02-01  362286.24
16   R.P. N° 043-2023-SERNANP 2023-02-01  260177.68
17   R.P. N° 043-2023-SERNANP 2023-02-01    9106.53
18   R.P. N° 032-2017-SERNANP 2017-01-31 2304596.68
19                       &lt;NA&gt; 1899-12-30  261127.28
20                       &lt;NA&gt; 1899-12-30   66699.00
21                       &lt;NA&gt; 1899-12-30    3492.40
22                       &lt;NA&gt; 1899-12-30   21614.02
23    R.P. N° 64-2017-SERNANP 2017-02-28  178434.11
24   R.P. N° 337-2018-SERNANP 2018-12-31  392819.65
25   R.P. N° 337-2018-SERNANP 2018-12-31  273370.45
26   R.P. N° 031-2017-SERNANP 2017-01-31   19009.20
27   R.P. N° 338-2018-SERNANP 2018-12-31  138965.15
28   R.P. N° 339-2018-SERNANP 2018-12-31  339499.85
29                       &lt;NA&gt; 1899-12-30   28404.36
30    R.P. N° 73-2014-SERNANP 2014-03-25  671363.75
31                       &lt;NA&gt; 1899-12-30  117141.77
32                       &lt;NA&gt; 1899-12-30   87651.54
33                       &lt;NA&gt; 1899-12-30  133083.09
34                       &lt;NA&gt; 1899-12-30  283545.59
35   R.P. N° 339-2022-SERNANP 2022-12-29  316383.50
36   R.P. N° 064-2023-SERNANP 2023-02-17    5208.08
37   R.P. N° 339-2022-SERNANP 2022-12-29    6371.03
38   R.P. N° 339-2022-SERNANP 2022-12-29  197205.13
39   R.P. Nº 184-2022-SERNANP 2022-08-04    8652.24
40                       &lt;NA&gt; 1899-12-30    4622.00
41   R.P. N° 169-2016-SERNANP 2016-08-05    1047.22
42   R.P. N° 273-2017-SERNANP 2017-11-30 1219807.51
43                       &lt;NA&gt; 1899-12-30  140885.51
44                       &lt;NA&gt; 1899-12-30    4045.57
45   R.P. N° 139-2016-SERNANP 2016-06-06  288188.56
46                       &lt;NA&gt; 1899-12-30    8236.84
47                       &lt;NA&gt; 1899-12-30    4153.80
48                       &lt;NA&gt; 1899-12-30    2994.30
49                       &lt;NA&gt; 1899-12-30      26.25
50                       &lt;NA&gt; 1899-12-30    1002.71
51   R.P. N° 134-2015-SERNANP 2015-07-09 1095646.64
52   R.P. N° 144-2020-SERNANP 2020-09-17    1880.50
53   R.P. N° 130-2017-SERNANP 2017-05-22    4100.13
54                       &lt;NA&gt; 1899-12-30   36660.57
55                       &lt;NA&gt; 1899-12-30   10506.92
56   R.P. Nº 027-2022-SERNANP 2022-01-20    4125.72
57   R.P. N° 336-2018-SERNANP 2018-12-31   29583.14
58   R.P. N° 062-2019-SERNANP 2019-02-25  222423.17
59   R.P. N° 071-2019-SERNANP 2019-03-10    3354.05
60   R.P. N° 079-2019-SERNANP 2019-03-14  485112.73
61   R.P. Nº 239-2019-SERNANP 2019-10-11   73256.14
62   R.P. N° 035-2019-SERNANP 2019-01-29   15650.38
63   R.P. N° 035-2019-SERNANP 2019-01-29   22027.06
64   R.P. N° 035-2019-SERNANP 2019-01-29  193877.91
65                       &lt;NA&gt; 1899-12-30   38887.63
66   R.P. N° 087-2019-SERNANP 2019-04-04  632382.65
67   R.P. N° 087-2019-SERNANP 2019-04-04  867663.35
68   R.P. N° 087-2019-SERNANP 2019-04-04  202033.34
69                       &lt;NA&gt; 1899-12-30  164565.27
70                       &lt;NA&gt; 1899-12-30  241073.13
71                       &lt;NA&gt; 1899-12-30   60785.61
72                       &lt;NA&gt; 1899-12-30  128192.77
73                       &lt;NA&gt; 1899-12-30   77891.55
74                       &lt;NA&gt; 1899-12-30   62423.85
75   R.P. N° 332-2022-SERNANP 2022-12-29  128479.57
76   R.P. N° 346-2016-SERNANP 2016-12-29   51379.07
77                       &lt;NA&gt; 1899-12-30  222953.88
78   R.P. N° 264-2022-SERNANP 2022-11-15  109438.36
79                       &lt;NA&gt; 1899-12-30    5499.98
80                       &lt;NA&gt; 1899-12-30   16655.73</code></pre>
</div>
</div>
<p>Hay una serie de <strong>funciones auxiliares</strong> que puedes usar dentro de <code>select()</code>:</p>
<ul>
<li><strong><code>starts_with("abc")</code></strong>: coincide con los nombres que comienzan con “abc”.</li>
<li><strong><code>ends_with("xyz")</code></strong>: coincide con los nombres que terminan con “xyz”.</li>
<li><strong><code>contains("ijk")</code></strong>: coincide con los nombres que contienen “ijk”.</li>
<li><strong><code>matches("(.)\\1")</code></strong>: selecciona variables que coinciden con una expresión regular <strong>(regex)</strong>. Esta en particular coincide con cualquier variable que contenga caracteres repetidos.</li>
<li><strong><code>num_range("x", 1:3)</code></strong>: coincide con x1,x2 y x3.</li>
</ul>
<p>Consulta <code>?select</code> para ver más detalles.</p>
<p><code>select()</code> se puede usar para cambiar el nombre de las variables, pero rara vez es útil porque descarta todas las variables que no se mencionan explícitamente. En su lugar, utiliza <strong><code>rename()</code></strong>, que es una variante de <code>select()</code> que mantiene todas las variables que no se mencionan explícitamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(z_amortiguamiento)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X"          "Codigo"     "Area_natur" "Periodo"    "Base_legal"
 [6] "Fecha_lega" "Base_leg00" "Fecha_le00" "Base_leg01" "Fecha_le01"
[11] "Superficie"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new name = old name</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rename</span>(z_amortiguamiento, <span class="st">"Baselegal"</span> <span class="ot">=</span> Base_legal)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X"          "Codigo"     "Area_natur" "Periodo"    "Baselegal" 
 [6] "Fecha_lega" "Base_leg00" "Fecha_le00" "Base_leg01" "Fecha_le01"
[11] "Superficie"</code></pre>
</div>
</div>
<p>Otra opción es usar <code>select()</code> junto con el auxiliar <strong><code>everything()</code></strong> (todo, en inglés). Esto es útil si tienes un grupo de variables que te gustaría mover al comienzo del data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(z_amortiguamiento, X, Superficie, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    X Superficie Codigo                          Area_natur   Periodo
1   1  325684.03   RC04                           Ashaninka 2019-2023
2   2   45367.20   BP03                          de Pui Pui 2019-2023
3   3  231397.76   RN12                              Matsés 2023-2027
4   4   65956.53   RN10                  Allpahuayo Mishana 2022-2026
5   5  310242.10   RN06          de Salinas y Aguada Blanca 2016-2020
6   6  100858.12   RN02                            de Junín 2008-2012
7   7   14530.51   RN01    Pampa Galeras Barbara D' Achille 2022-2026
8   8    9291.39   SH04                     Bosque de Pomac 2017-2021
9   9     429.19   SH02             de la Pampa de Ayacucho 2016-2020
10 10    1332.28   SH01                       de Chacamarca 2002-2007
11 11   18866.71   SN09                 Cordillera de Colán 2016-2020
12 12   44993.90   SN08                  Tabaconas-Namballe 2023-2027
13 13    5702.07   SN04                            de Ampay 2015-2019
14 14    4843.62   SN01                         de Huayllay 2018-2022
15 15  362286.24   PN14                  Sierra del Divisor 2023-2027
16 16  260177.68   PN14                  Sierra del Divisor 2023-2027
17 17    9106.53   PN14                  Sierra del Divisor 2023-2027
18 18 2304596.68   PN09                     Cordillera Azul 2017-2021
19 19  261127.28   PN08                      Bahuaja-Sonene 2015-2019
20 20   66699.00   PN05                   Cerros de Amotape 2012-2017
21 21    3492.40   PN05                   Cerros de Amotape 2012-2017
22 22   21614.02   PN05                   Cerros de Amotape 2012-2017
23 23  178434.11   PN04                           Huascarán 2017-2021
24 24  392819.65   PN03                            del Manu 2019-2023
25 25  273370.45   PN03                            del Manu 2019-2023
26 26   19009.20   PN01                          de Cutervo 2017-2021
27 27  138965.15   PN12 Ichigkat Muja-Cordillera del Cóndor 2019-2023
28 28  339499.85   RN14                            Pucacuro 2019-2023
29 29   28404.36   CC02                         Sunchubamba      &lt;NA&gt;
30 30  671363.75   PN06                      del Río Abiseo 2014-2019
31 31  117141.77   ZR03                    Santiago Comaina      &lt;NA&gt;
32 32   87651.54   ZR03                    Santiago Comaina      &lt;NA&gt;
33 33  133083.09   SH03                         Machupicchu 2015-2019
34 34  283545.59   RC03                          Amarakaeri 2016-2020
35 35  316383.50   RC05                         Machiguenga 2023-2027
36 36    5208.08   SN05             los Manglares de Tumbes 2023-2027
37 37    6371.03   RC05                         Machiguenga 2023-2027
38 38  197205.13   RC05                         Machiguenga 2023-2027
39 39    8652.24   SN07                       Pampa Hermosa 2022-2027
40 40    4622.00  RVS01                          Laquipampa 2015-2019
41 41    1047.22  RVS02               Los Pantanos de Villa 2016-2020
42 42 1219807.51   RN08                      Pacaya-Samiria 2017-2021
43 43  140885.51   RN03                          de Paracas 2016-2020
44 44    4045.57   ZR01                        Chancaybaños      &lt;NA&gt;
45 45  288188.56   RC07                           Tuntanain 2016-2020
46 46    8236.84   RC08                          Chayu Naín      &lt;NA&gt;
47 47    4153.80   RC08                          Chayu Naín      &lt;NA&gt;
48 48    2994.30  RVS03           Bosques Nublados de Udima 2015-2019
49 49      26.25  RVS03           Bosques Nublados de Udima 2015-2019
50 50    1002.71  RVS03           Bosques Nublados de Udima 2015-2019
51 51 1095646.64   RC02                             El Sira 2015-2019
52 52    1880.50   SN03                    Lagunas de Mejía 2015-2019
53 53    4100.13   BP05                       de Pagaibamba 2017-2021
54 54   36660.57   RN07                          de Calipuy 2015-2019
55 55   10506.92   SN02                          de Calipuy 2015-2019
56 56    4125.72   PN02                      de Tingo María 2022-2026
57 57   29583.14   CC01                           El Angolo 2019-2023
58 58  222423.17   RC06                               Purús 2019-2023
59 59    3354.05   RN04                           de Lachay 2019-2023
60 60  485112.73   RP02             Subcuenca del Cotahuasi 2019-2023
61 61   73256.14   RN15                        San Fernando 2019-2024
62 62   15650.38   RN09                           Tambopata 2019-2023
63 63   22027.06   RN09                           Tambopata 2019-2023
64 64  193877.91   RN09                           Tambopata 2019-2023
65 65   38887.63   PN10                              Otishi 2016-2020
66 66  632382.65   PN11                          Alto Purús 2019-2023
67 67  867663.35   PN11                          Alto Purús 2019-2023
68 68  202033.34   PN11                          Alto Purús 2019-2023
69 69  164565.27   RN05                        del Titicaca 2021-2025
70 70  241073.13   PN15                              Yaguas 2021-2025
71 71   60785.61   PN07                 Yanachaga-Chemillén 2022-2026
72 72  128192.77   SN06                           Megantoni 2022-2026
73 73   77891.55   SN06                           Megantoni 2022-2026
74 74   62423.85   RC09                            Airo Pai 2022-2026
75 75  128479.57   BP04               San Matias-San Carlos 2023-2027
76 76   51379.07   RC01                             Yanesha 2017-2021
77 77  222953.88   BP06                           Alto Mayo 2023-2027
78 78  109438.36   RP01                   Nor Yauyos-Cochas 2022-2027
79 79    5499.98   RC10                             Huimeki 2023-2027
80 80   16655.73   RC10                             Huimeki 2023-2027
                   Base_legal Fecha_lega               Base_leg00 Fecha_le00
1    R.P. Nº 239-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
2     R.J. Nº 285-2008 INRENA 2008-10-28                     &lt;NA&gt; 1899-12-30
3  R.P. Nº 054-2014-SERNANP-J 2014-02-27                     &lt;NA&gt; 1899-12-30
4     R.J. Nº 159-2007 INRENA 2007-07-24                     &lt;NA&gt; 1899-12-30
5     R.J. Nº 087-2007 INRENA 2007-04-26                     &lt;NA&gt; 1899-12-30
6     R.J. Nº 145-2008 INRENA 2008-06-03                     &lt;NA&gt; 1899-12-30
7     R.J. Nº 331-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
8    R.P. Nº 006-2011-SERNANP 2011-01-19                     &lt;NA&gt; 1899-12-30
9    R.P. N° 019-2016-SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
10    R.J. Nº 466-2002-INRENA 2002-12-20                     &lt;NA&gt; 1899-12-30
11   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
12    R.J. Nº 015-2007 INRENA 2007-01-22                     &lt;NA&gt; 1899-12-30
13   R.P. Nº 168-2015-SERNANP 2014-12-22                     &lt;NA&gt; 1899-12-30
14    R.J. Nº 325-2001 INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
15   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
16   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
17   R.P. N° 295-2016-SERNANP 2016-11-07                     &lt;NA&gt; 1899-12-30
18   R.P. Nº 064-2011-SERNANP 2011-04-14                     &lt;NA&gt; 1899-12-30
19   R.P. Nº 111-2015-SERNANP 2015-06-10                     &lt;NA&gt; 1899-12-30
20   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
21   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
22   R.P. N° 039-2012-SERNANP 2012-02-17             Ley N° 30359 2015-11-11
23   R.P. Nº 241-2010-SERNANP 2010-12-30                     &lt;NA&gt; 1899-12-30
24   R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
25   R.P. Nº 087-2013-SERNANP 2013-05-22                     &lt;NA&gt; 1899-12-30
26   R.P. Nº 175-2009-SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
27    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
28   R.P. Nº 047-2013-SERNANP 2013-03-20                     &lt;NA&gt; 1899-12-30
29    R.J. Nº 303-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
30   R.J. Nº 253 -2006 INRENA 2006-09-27                     &lt;NA&gt; 1899-12-30
31    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
32    R.J. Nº 211-2007-INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
33   R.P. Nº 070-2015-SERNANP 2015-04-17                     &lt;NA&gt; 1899-12-30
34   R.P. N° 198-2016-SERNANP 2016-07-26                     &lt;NA&gt; 1899-12-30
35   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
36   R.P. N° 063-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
37   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
38   R.P. N° 065-2017-SERNANP 2017-02-28                     &lt;NA&gt; 1899-12-30
39   R.P. Nº 213-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
40   R.P. Nº 014-2015-SERNANP 2015-01-27                     &lt;NA&gt; 1899-12-30
41    R.J. Nº 358-2001-INRENA 2001-12-28                     &lt;NA&gt; 1899-12-30
42   R.J. Nº 173-2009 SERNANP 2009-09-24                     &lt;NA&gt; 1899-12-30
43   R.P. Nº 020-2016 SERNANP 2016-01-29                     &lt;NA&gt; 1899-12-30
44    R.J. Nº 337-2001-INRENA 2001-12-26                     &lt;NA&gt; 1899-12-30
45    R.J. Nº 211-2007 INRENA 2007-09-12                     &lt;NA&gt; 1899-12-30
46   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
47   R.P. Nº 026-2011-SERNANP 2011-02-18                     &lt;NA&gt; 1899-12-30
48   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
49   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
50   R.P. Nº 052-2015-SERNANP 2015-03-16                     &lt;NA&gt; 1899-12-30
51   R.P. Nº 044-2009 SERNANP 2009-02-27                     &lt;NA&gt; 1899-12-30
52   R.P. Nº 238-2015-SERNANP 2015-10-29                     &lt;NA&gt; 1899-12-30
53    R.J. Nº 306-2001-INRENA 2001-12-13                     &lt;NA&gt; 1899-12-30
54   R.P. Nº 032-2015-SERNANP 2015-02-18                     &lt;NA&gt; 1899-12-30
55   R.P. Nº 021-2015-SERNANP 2015-02-10                     &lt;NA&gt; 1899-12-30
56   R.P. N° 090-2017-SERNANP 2017-03-31                     &lt;NA&gt; 1899-12-30
57   R.P. N° 212-2012-SERNANP 2012-11-28                     &lt;NA&gt; 1899-12-30
58   R.P. Nº 003-2013-SERNANP 1899-12-30                     &lt;NA&gt; 1899-12-30
59   R.P. Nº 090-2013-SERNANP 2013-05-30                     &lt;NA&gt; 1899-12-30
60   R.P. Nº 163-2009 SERNANP 2009-09-15                     &lt;NA&gt; 1899-12-30
61   R.P. Nº 118-2015-SERNANP 2015-06-19                     &lt;NA&gt; 1899-12-30
62    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
63    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
64    R.J. Nº 290-2005 INRENA 2005-12-06 R.P. N° 240-2017-SERNANP 2017-10-02
65   R.P. N° 290-2016-SERNANP 2016-10-31                     &lt;NA&gt; 1899-12-30
66   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
67   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
68   R.P. Nº 238-2012-SERNANP 2012-12-28                     &lt;NA&gt; 1899-12-30
69   R.P. N° 038-2021-SERNANP 2021-02-12                     &lt;NA&gt; 1899-12-30
70   R.P. Nº 085-2021-SERNANP 2021-04-23                     &lt;NA&gt; 1899-12-30
71   R.P. N° 011-2022-SERNANP 2022-01-13                     &lt;NA&gt; 1899-12-30
72   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
73   R.P. Nº 024-2022-SERNANP 2022-01-20                     &lt;NA&gt; 1899-12-30
74   R.P. N° 058-2022-SERNANP 2022-02-16                     &lt;NA&gt; 1899-12-30
75   R.P. N° 268-2015-SERNANP 2015-11-27                     &lt;NA&gt; 1899-12-30
76   R.J. Nº 129-2011-SERNANP 2011-07-01                     &lt;NA&gt; 1899-12-30
77   R.P. Nº 069-2023-SERNANP 2023-02-27                     &lt;NA&gt; 1899-12-30
78    R.J. Nº 194-2006 INRENA 2006-07-20                     &lt;NA&gt; 1899-12-30
79    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
80    R.P N° 080-2023-SERNANP 2023-03-01                     &lt;NA&gt; 1899-12-30
                   Base_leg01 Fecha_le01
1    R.P. N° 034-2019-SERNANP 2019-01-29
2    R.P. N° 033-2019-SERNANP 2019-01-29
3     R.P N° 320-2022-SERNANP 2022-12-29
4    R.P. N° 082-2022-SERNANP 2022-03-15
5    R.P. N° 257-2016-SERNANP 2016-09-14
6                        &lt;NA&gt; 1899-12-30
7  R.P. N° 069-2022-SERNANP\n 2022-03-02
8     R.P. N° 91-2017-SERNANP 2017-03-31
9                        &lt;NA&gt; 1899-12-30
10                       &lt;NA&gt; 1899-12-30
11   R.P. N° 140-2016-SERNANP 2016-06-06
12   R.P. N° 338-2022-SERNANP 2022-12-29
13   R.P. Nº 012-2022-SERNANP 2022-01-13
14   R.P. N° 268-2018-SERNANP 2018-11-05
15   R.P. N° 043-2023-SERNANP 2023-02-01
16   R.P. N° 043-2023-SERNANP 2023-02-01
17   R.P. N° 043-2023-SERNANP 2023-02-01
18   R.P. N° 032-2017-SERNANP 2017-01-31
19                       &lt;NA&gt; 1899-12-30
20                       &lt;NA&gt; 1899-12-30
21                       &lt;NA&gt; 1899-12-30
22                       &lt;NA&gt; 1899-12-30
23    R.P. N° 64-2017-SERNANP 2017-02-28
24   R.P. N° 337-2018-SERNANP 2018-12-31
25   R.P. N° 337-2018-SERNANP 2018-12-31
26   R.P. N° 031-2017-SERNANP 2017-01-31
27   R.P. N° 338-2018-SERNANP 2018-12-31
28   R.P. N° 339-2018-SERNANP 2018-12-31
29                       &lt;NA&gt; 1899-12-30
30    R.P. N° 73-2014-SERNANP 2014-03-25
31                       &lt;NA&gt; 1899-12-30
32                       &lt;NA&gt; 1899-12-30
33                       &lt;NA&gt; 1899-12-30
34                       &lt;NA&gt; 1899-12-30
35   R.P. N° 339-2022-SERNANP 2022-12-29
36   R.P. N° 064-2023-SERNANP 2023-02-17
37   R.P. N° 339-2022-SERNANP 2022-12-29
38   R.P. N° 339-2022-SERNANP 2022-12-29
39   R.P. Nº 184-2022-SERNANP 2022-08-04
40                       &lt;NA&gt; 1899-12-30
41   R.P. N° 169-2016-SERNANP 2016-08-05
42   R.P. N° 273-2017-SERNANP 2017-11-30
43                       &lt;NA&gt; 1899-12-30
44                       &lt;NA&gt; 1899-12-30
45   R.P. N° 139-2016-SERNANP 2016-06-06
46                       &lt;NA&gt; 1899-12-30
47                       &lt;NA&gt; 1899-12-30
48                       &lt;NA&gt; 1899-12-30
49                       &lt;NA&gt; 1899-12-30
50                       &lt;NA&gt; 1899-12-30
51   R.P. N° 134-2015-SERNANP 2015-07-09
52   R.P. N° 144-2020-SERNANP 2020-09-17
53   R.P. N° 130-2017-SERNANP 2017-05-22
54                       &lt;NA&gt; 1899-12-30
55                       &lt;NA&gt; 1899-12-30
56   R.P. Nº 027-2022-SERNANP 2022-01-20
57   R.P. N° 336-2018-SERNANP 2018-12-31
58   R.P. N° 062-2019-SERNANP 2019-02-25
59   R.P. N° 071-2019-SERNANP 2019-03-10
60   R.P. N° 079-2019-SERNANP 2019-03-14
61   R.P. Nº 239-2019-SERNANP 2019-10-11
62   R.P. N° 035-2019-SERNANP 2019-01-29
63   R.P. N° 035-2019-SERNANP 2019-01-29
64   R.P. N° 035-2019-SERNANP 2019-01-29
65                       &lt;NA&gt; 1899-12-30
66   R.P. N° 087-2019-SERNANP 2019-04-04
67   R.P. N° 087-2019-SERNANP 2019-04-04
68   R.P. N° 087-2019-SERNANP 2019-04-04
69                       &lt;NA&gt; 1899-12-30
70                       &lt;NA&gt; 1899-12-30
71                       &lt;NA&gt; 1899-12-30
72                       &lt;NA&gt; 1899-12-30
73                       &lt;NA&gt; 1899-12-30
74                       &lt;NA&gt; 1899-12-30
75   R.P. N° 332-2022-SERNANP 2022-12-29
76   R.P. N° 346-2016-SERNANP 2016-12-29
77                       &lt;NA&gt; 1899-12-30
78   R.P. N° 264-2022-SERNANP 2022-11-15
79                       &lt;NA&gt; 1899-12-30
80                       &lt;NA&gt; 1899-12-30</code></pre>
</div>
</div>
</section>
<section id="añadir-nuevas-variables-con-mutate" class="level3">
<h3 class="anchored" data-anchor-id="añadir-nuevas-variables-con-mutate">Añadir nuevas variables con mutate()</h3>
<p align="center">
<img width="500" src="fig/mutate.png">
</p>
<p>Además de seleccionar conjuntos de columnas existentes, a menudo es útil crear nuevas columnas en función de columnas existentes. Ese es el trabajo de <strong><code>mutate()</code></strong> (del inglés mutar o transformar).</p>
<p><strong><code>mutate()</code></strong> siempre agrega nuevas columnas al final de un conjunto de datos, así que comenzaremos creando un conjunto de datos más pequeño para que podamos ver las nuevas variables. Recuerda que cuando usas <strong>RStudio</strong>, la manera más fácil de ver todas las columnas es <strong>View()</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="ot">&lt;-</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    flights,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    year<span class="sc">:</span>day,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ends_with</span>(<span class="st">"delay"</span>),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    distance, air_time</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  flights_sml,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">speed =</span> distance <span class="sc">/</span> (air_time <span class="sc">*</span> <span class="dv">60</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 9
    year month   day dep_delay arr_delay distance air_time  gain  speed
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227     9 0.103 
 2  2013     1     1         4        20     1416      227    16 0.104 
 3  2013     1     1         2        33     1089      160    31 0.113 
 4  2013     1     1        -1       -18     1576      183   -17 0.144 
 5  2013     1     1        -6       -25      762      116   -19 0.109 
 6  2013     1     1        -4        12      719      150    16 0.0799
 7  2013     1     1        -5        19     1065      158    24 0.112 
 8  2013     1     1        -3       -14      229       53   -11 0.0720
 9  2013     1     1        -3        -8      944      140    -5 0.112 
10  2013     1     1        -2         8      733      138    10 0.0885
# … with 336,766 more rows</code></pre>
</div>
</div>
<p>Ten en cuenta que puedes hacer referencia a las columnas que acabas de crear:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  flights_sml,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 10
    year month   day dep_delay arr_delay distance air_time  gain hours gain_pe…¹
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1  2013     1     1         2        11     1400      227     9 3.78       2.38
 2  2013     1     1         4        20     1416      227    16 3.78       4.23
 3  2013     1     1         2        33     1089      160    31 2.67      11.6 
 4  2013     1     1        -1       -18     1576      183   -17 3.05      -5.57
 5  2013     1     1        -6       -25      762      116   -19 1.93      -9.83
 6  2013     1     1        -4        12      719      150    16 2.5        6.4 
 7  2013     1     1        -5        19     1065      158    24 2.63       9.11
 8  2013     1     1        -3       -14      229       53   -11 0.883    -12.5 
 9  2013     1     1        -3        -8      944      140    -5 2.33      -2.14
10  2013     1     1        -2         8      733      138    10 2.3        4.35
# … with 336,766 more rows, and abbreviated variable name ¹​gain_per_hour</code></pre>
</div>
</div>
<p>Si solo quieres conservar las nuevas variables, usa <strong><code>transmute()</code></strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  flights,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
    gain hours gain_per_hour
   &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
 1     9 3.78           2.38
 2    16 3.78           4.23
 3    31 2.67          11.6 
 4   -17 3.05          -5.57
 5   -19 1.93          -9.83
 6    16 2.5            6.4 
 7    24 2.63           9.11
 8   -11 0.883        -12.5 
 9    -5 2.33          -2.14
10    10 2.3            4.35
# … with 336,766 more rows</code></pre>
</div>
</div>
<section id="funciones-de-creación-útiles" class="level4">
<h4 class="anchored" data-anchor-id="funciones-de-creación-útiles">Funciones de creación útiles</h4>
<p>Hay muchas funciones para crear nuevas variables que puedes usar con <code>mutate()</code>. La propiedad clave es que la función debe ser vectorizada: debe tomar un vector de valores como input, y devolver un vector con el mismo número de valores como output. No hay forma de enumerar todas las posibles funciones que podrías usar, pero aquí hay una selección de funciones que frecuentemente son útiles:</p>
<ul>
<li><p>Operadores aritméticos: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>. Todos están vectorizados usando las llamadas <strong>“reglas de reciclaje”</strong>. Si un parámetro es más corto que el otro, se extenderá automáticamente para tener la misma longitud. Esto es muy útil cuando uno de los argumentos es un solo número: <code>air_time / 60</code>, <code>hours * 60 + minute</code>, etc. Los operadores aritméticos también son útiles junto con las funciones de agregar que aprenderás más adelante. Por ejemplo, <code>x / sum(x)</code> calcula la proporción de un total, y <code>y - mean(y)</code> calcula la diferencia de la media.</p></li>
<li><p><strong>Aritmética modular</strong>: <strong><code>%/%</code></strong> (división entera) y <strong><code>%%</code></strong> (resto), donde <code>x == y * (x %/% y) + (x %% y)</code>. La aritmética modular es una herramienta útil porque te permite dividir enteros en partes. Por ejemplo, en el conjunto de datos de vuelos, puedes calcular hora y minutos de <strong><code>dep_time</code></strong> con:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  flights,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  dep_time,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hour =</span> dep_time <span class="sc">%/%</span> <span class="dv">100</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">minute =</span> dep_time <span class="sc">%%</span> <span class="dv">100</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
   dep_time  hour minute
      &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1      517     5     17
 2      533     5     33
 3      542     5     42
 4      544     5     44
 5      554     5     54
 6      554     5     54
 7      555     5     55
 8      557     5     57
 9      557     5     57
10      558     5     58
# … with 336,766 more rows</code></pre>
</div>
</div>
<ul>
<li><p><strong>Logaritmos:</strong> <code>log()</code>, <code>log2()</code>, <code>log10()</code>. Los logaritmos son increíblemente útiles como transformación para trabajar con datos con múltiples órdenes de magnitud. También convierten las relaciones multiplicativas en aditivas, una característica que retomaremos en los capítulos sobre modelos. En igualdad de condiciones, recomendamos usar <code>log2()</code> porque es más fácil de interpretar: una diferencia de 1 en la escala de registro corresponde a la duplicación de la escala original y una diferencia de -1 corresponde a dividir a la mitad.</p></li>
<li><p><strong>Rezagos:</strong> <code>lead()</code> y <code>lag()</code> te permiten referirte a un valor adelante o un valor atrás (con rezago). Esto te permite calcular las diferencias móviles (por ejemplo, <code>x - lag(x)</code>) o encontrar cuándo cambian los valores <code>(x! = lag (x))</code>. Estos comandos son más útiles cuando se utilizan junto con <code>group_by()</code>, algo que aprenderás en breve.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lag</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] NA  1  2  3  4  5  6  7  8  9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lead</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  2  3  4  5  6  7  8  9 10 NA</code></pre>
</div>
</div>
<ul>
<li><strong>Agregados acumulativos y móviles:</strong> R proporciona funciones para ejecutar sumas, productos, mínimos y máximos: <code>cumsum()</code>, <code>cumprod()</code>, <code>cummin()</code>, <code>cummax()</code>; <strong>dplyr</strong>, por su parte, proporciona <code>cummean()</code> para las medias acumuladas. Si necesitas calcular agregados móviles (es decir, una suma calculada en una ventana móvil), prueba el paquete <strong>RcppRoll</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  3  6 10 15 21 28 36 45 55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cummean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5</code></pre>
</div>
</div>
<ul>
<li><p>Comparaciones lógicas: <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>!=</code> sobre las cuales aprendiste antes. Si estás haciendo una secuencia compleja de operaciones lógicas, es a menudo una buena idea almacenar los valores provisionales en nuevas variables para que puedas comprobar que cada paso funciona como se espera.</p></li>
<li><p>Ordenamiento: hay una serie de funciones de ordenamiento (ranking), pero deberías comenzar con <code>min_rank()</code>. Esta función realiza el tipo más común de ordenamiento (por ejemplo, primero, segundo, tercero, etc.). El valor predeterminado otorga la menor posición a los valores más pequeños; usa <code>desc(x)</code> para dar la menor posición a los valores más grandes.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min_rank</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  2 NA  4  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min_rank</span>(<span class="fu">desc</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5  3  3 NA  2  1</code></pre>
</div>
</div>
<ul>
<li>Si <code>min_rank()</code> no hace lo que necesitas, consulta las variantes <code>row_number()</code>, <code>dense_rank()</code>, <code>percent_rank()</code>, <code>cume_dist()</code>, <code>quantile()</code>. Revisa sus páginas de ayuda para más detalles.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row_number</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  3 NA  4  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dense_rank</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2  2 NA  3  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">percent_rank</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00 0.25 0.25   NA 0.75 1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cume_dist</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2 0.6 0.6  NA 0.8 1.0</code></pre>
</div>
</div>
</section>
</section>
<section id="resúmenes-agrupados-con-summarise" class="level3">
<h3 class="anchored" data-anchor-id="resúmenes-agrupados-con-summarise">Resúmenes agrupados con summarise()</h3>
<p>El último verbo clave es <strong><code>summarise()</code></strong> (resumir, en inglés). Se encarga de colapsar un data frame en una sola fila:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(flights, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  delay
  &lt;dbl&gt;
1  12.6</code></pre>
</div>
</div>
<p><code>summarise()</code> no es muy útil a menos que lo enlacemos con <code>group_by()</code>. Esto cambia la unidad de análisis del conjunto de datos completo a grupos individuales. Luego, cuando uses los verbos <strong>dplyr</strong> en un data frame agrupado, estos se aplicarán automáticamente <strong>“por grupo”</strong>. Por ejemplo, si aplicamos exactamente el mismo código a un dataframe agrupado por fecha, obtenemos el retraso promedio por fecha:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>by_day <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, year, month, day)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(by_day, <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2013     1     1 11.5 
 2  2013     1     2 13.9 
 3  2013     1     3 11.0 
 4  2013     1     4  8.95
 5  2013     1     5  5.73
 6  2013     1     6  7.15
 7  2013     1     7  5.42
 8  2013     1     8  2.55
 9  2013     1     9  2.28
10  2013     1    10  2.84
# … with 355 more rows</code></pre>
</div>
</div>
<p>Juntos <code>group_by()</code> y <code>summarise()</code> proporcionan una de las herramientas que más comúnmente usarás cuando trabajes con dplyr: resúmenes agrupados. Pero antes de ir más allá con esto, tenemos que introducir una idea nueva y poderosa: el <code>pipe</code> (pronunciado /paip/, que en inglés significa ducto o tubería).</p>
</section>
</section>
<section id="combinación-de-múltiples-operaciones-con-el-pipe" class="level2">
<h2 class="anchored" data-anchor-id="combinación-de-múltiples-operaciones-con-el-pipe">Combinación de múltiples operaciones con el pipe</h2>
<p>Imagina que queremos explorar la relación entre la distancia y el atraso promedio para cada ubicación. Usando lo que sabes acerca de dplyr, podrías escribir un código como este:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>by_dest <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, dest)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>delay <span class="ot">&lt;-</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    by_dest,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Parece que las demoras aumentan con las distancias hasta ~ 750 millas</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># y luego disminuyen. ¿Tal vez a medida que los vuelos se hacen más </span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co"># largos, hay más habilidad para compensar las demoras en el aire?</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> delay, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> delay)) <span class="sc">+</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> count), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="c03_parte2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hay tres pasos para preparar esta información:</p>
<ol type="1">
<li>Agrupar los vuelos por destino.</li>
<li>Resumir para calcular la distancia, la demora promedio y el número de vuelos en cada grupo.</li>
<li>Filtrar para eliminar puntos ruidosos y el aeropuerto de Honolulu, que está casi dos veces más lejos que el próximo aeropuerto más cercano.</li>
</ol>
<p>Es un poco frustrante escribir este código porque tenemos que dar un nombre a cada data frame intermedio, incluso si el dataframe en sí mismo no nos importa. Nombrar cosas es difícil y <strong>dilata el tiempo</strong> de nuestro análisis.</p>
<p>Hay otra forma de abordar el mismo problema con el pipe, <strong><code>%&gt;%</code></strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>delays <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist =</span> <span class="fu">mean</span>(distance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">20</span>, dest <span class="sc">!=</span> <span class="st">"HNL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Este código se enfoca en las transformaciones, no en lo que se está transformando, lo que hace que sea más fácil de leer. Puedes leerlo como una serie de declaraciones imperativas: <strong>agrupa</strong>, luego <strong>resume</strong> y luego <strong>filtra</strong>. Como sugiere esta lectura, una buena forma de pronunciar <strong><code>%&gt;%</code></strong> cuando se lee el código es <strong>“luego”</strong>.</p>
<p>Lo que ocurre detrás del código, es que <strong>x %&gt;% f(y)</strong> se convierte en <strong>f(x, y)</strong>, y <strong>x %&gt;% f(y) %&gt;% g(z)</strong> se convierte en <strong>g(f(x, y), z)</strong> y así sucesivamente. Puedes usar el <strong><em>pipe</em></strong> para reescribir múltiples operaciones de forma que puedas leer de izquierda a derecha, de arriba hacia abajo. <strong>Usaremos pipes con frecuencia a partir de ahora porque mejora considerablemente la legibilidad del código</strong>. Volveremos a este tema con más detalles en pipes.</p>
<p>Trabajar con el pipe es uno de los criterios clave para pertenecer al tidyverse. La única excepción es ggplot2: se escribió antes de que se descubriera el pipe. Lamentablemente, la siguiente iteración de ggplot2, ggvis, que sí utiliza el pipe, aún no está lista para el horario estelar.</p>
<section id="valores-faltantes" class="level3">
<h3 class="anchored" data-anchor-id="valores-faltantes">Valores faltantes</h3>
<p>Es posible que te hayas preguntado sobre el argumento na.rm que utilizamos anteriormente. ¿Qué pasa si no lo configuramos?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day  mean
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2013     1     1    NA
 2  2013     1     2    NA
 3  2013     1     3    NA
 4  2013     1     4    NA
 5  2013     1     5    NA
 6  2013     1     6    NA
 7  2013     1     7    NA
 8  2013     1     8    NA
 9  2013     1     9    NA
10  2013     1    10    NA
# … with 355 more rows</code></pre>
</div>
</div>
<p>¡Obtenemos muchos valores faltantes! Esto se debe a que las funciones de agregación obedecen la regla habitual de valores faltantes: <strong>si hay uno en el input</strong>, <strong>el output también será un valor faltante</strong>. Afortunadamente, todas las funciones de agregación tienen un argumento <strong><code>na.rm</code></strong> que elimina los valores faltantes antes del cálculo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day  mean
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2013     1     1 11.5 
 2  2013     1     2 13.9 
 3  2013     1     3 11.0 
 4  2013     1     4  8.95
 5  2013     1     5  5.73
 6  2013     1     6  7.15
 7  2013     1     7  5.42
 8  2013     1     8  2.55
 9  2013     1     9  2.28
10  2013     1    10  2.84
# … with 355 more rows</code></pre>
</div>
</div>
<p>En este caso, en el que los valores faltantes representan vuelos cancelados, también podríamos abordar el problema eliminando primero este tipo de vuelos. Guardaremos este conjunto de datos para poder reutilizarlo en los siguientes ejemplos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay), <span class="sc">!</span><span class="fu">is.na</span>(arr_delay))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day  mean
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1  2013     1     1 11.4 
 2  2013     1     2 13.7 
 3  2013     1     3 10.9 
 4  2013     1     4  8.97
 5  2013     1     5  5.73
 6  2013     1     6  7.15
 7  2013     1     7  5.42
 8  2013     1     8  2.56
 9  2013     1     9  2.30
10  2013     1    10  2.84
# … with 355 more rows</code></pre>
</div>
</div>
<section id="conteos" class="level4">
<h4 class="anchored" data-anchor-id="conteos">Conteos</h4>
<p>Siempre que realices una agregación, es una buena idea incluir un conteo (<strong>n()</strong>) o un recuento de valores no faltantes (<strong>sum(!is.na(x))</strong>). De esta forma, puedes verificar que no estás sacando conclusiones basadas en cantidades muy pequeñas de datos. Por ejemplo, veamos los aviones (identificados por su número de cola) que tienen las demoras promedio más altas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>delays <span class="ot">&lt;-</span> not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tailnum) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> delays, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> delay)) <span class="sc">+</span> </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="c03_parte2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<span style="color:blue">¡Hay algunos aviones que tienen una demora promedio de 5 horas (300 minutos)!</span>
<p></p>
<p>La historia es en realidad un poco más matizada. Podemos obtener más información si hacemos un diagrama de dispersión del número de vuelos contra la demora promedio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>delays <span class="ot">&lt;-</span> not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tailnum) <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> delays, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> delay)) <span class="sc">+</span> </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="c03_parte2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>No es sorprendente que haya una mayor variación en el promedio de retraso cuando hay pocos vuelos. La forma de este gráfico es muy característica: cuando trazas un promedio (o cualquier otra medida de resumen) contra el tamaño del grupo, verás que la variación decrece a medida que el tamaño de muestra aumenta.</p>
<p>Cuando se observa este tipo de gráficos, resulta útil eliminar los grupos con menor número de observaciones, ya que puedes ver más del patrón y menos de la variación extrema de los grupos pequeños. Esto es lo que hace el siguiente bloque de código. También te ofrece una manera muy útil para integrar ggplot2 en el flujo de trabajo de dplyr. <strong>Es un poco incómodo tener que cambiar de %&gt;% a +</strong>, pero una vez que entiendas el código, verás que es bastante conveniente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>delays <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> delay)) <span class="sc">+</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="c03_parte2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<p>Hay otra variación común de este tipo de patrón. Veamos cómo el rendimiento promedio de los bateadores en el béisbol está relacionado con el número de veces que les toca batear. Aquí utilizaremos el conjunto de datos de bateadores para calcular el promedio de bateo (número de bateos / número de intentos) de cada jugador de béisbol de las Grandes Ligas.</p>
<p>Cuando graficamos la habilidad del bateador (medido por el promedio de bateo, pb) contra el número de oportunidades para golpear la pelota (medido por el tiempo al bate,ab), verás dos patrones:</p>
<ol type="1">
<li><p>Como en el ejemplo anterior, la variación en nuestro estadístico de resumen disminuye a medida que obtenemos más observaciones.</p></li>
<li><p>Existe una correlación positiva entre la habilidad (pb) y las oportunidades para golpear la pelota (ab). Esto se debe a que los equipos controlan quién puede jugar y, obviamente, elegirán a sus mejores jugadores.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a tibble so it prints nicely</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>bateo <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(datos<span class="sc">::</span>bateadores)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>rendimiento_bateadores <span class="ot">&lt;-</span> bateo <span class="sc">%&gt;%</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id_jugador) <span class="sc">%&gt;%</span> </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pb =</span> <span class="fu">sum</span>(golpes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(al_bate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ab =</span> <span class="fu">sum</span>(al_bate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>rendimiento_bateadores <span class="sc">%&gt;%</span> </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ab <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> ab, <span class="at">y =</span> pb)) <span class="sc">+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="c03_parte2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Esto también tiene implicaciones importantes para la clasificación. Si ingenuamente ordenas <strong><code>desc(pb)</code></strong>, verás que las personas con los mejores promedios de bateo tienen claramente mucha suerte, pero no son necesariamente hábiles:</p>
<p>Puedes encontrar una buena explicación de este problema en <a href="http://varianceexplained.org/r/empirical_bayes_baseball/">http://varianceexplained.org/r/empirical_bayes_baseball/</a> y <a href="http://www.evanmiller.org/how-not-to-sort-by-average-rating.html">http://www.evanmiller.org/how-not-to-sort-by-average-rating.html</a>.</p>
</section>
</section>
</section>
<section id="funciones-de-resumen-útiles" class="level2">
<h2 class="anchored" data-anchor-id="funciones-de-resumen-útiles">Funciones de resumen útiles</h2>
<p>Solo el uso de medias, conteos y sumas puede llevarte muy lejos, pero R proporciona muchas otras funciones de resumen útiles:</p>
<ul>
<li><strong>Medidas de posición:</strong> <code>first(x)</code>, <code>nth(x, 2)</code>, <code>last(x)</code>. Estas trabajan de forma similar a <code>x[1]</code>, <code>x[2]</code> y <code>x[length (x)]</code>, pero te permiten establecer un valor predeterminado en el caso de que esa posición no exista (es decir, si estás tratando de obtener el tercer elemento de un grupo que solo tiene dos elementos). Por ejemplo, podemos encontrar la primera (first) y última (last) salida para cada día:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_dep =</span> <span class="fu">first</span>(dep_time), </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_dep =</span> <span class="fu">last</span>(dep_time)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 5
# Groups:   year, month [12]
    year month   day first_dep last_dep
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;    &lt;int&gt;
 1  2013     1     1       517     2356
 2  2013     1     2        42     2354
 3  2013     1     3        32     2349
 4  2013     1     4        25     2358
 5  2013     1     5        14     2357
 6  2013     1     6        16     2355
 7  2013     1     7        49     2359
 8  2013     1     8       454     2351
 9  2013     1     9         2     2252
10  2013     1    10         3     2320
# … with 355 more rows</code></pre>
</div>
</div>
<ul>
<li><strong>Medidas de centralidad:</strong> hemos usado <code>mean(x)</code>, pero <code>median(x)</code> también resulta muy útil. La media es la suma dividida por el número de observaciones; la mediana es un valor donde el 50% de x está por encima de él y el 50% está por debajo. A veces es útil combinar agregación con un subconjunto lógico.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_delay1 =</span> <span class="fu">mean</span>(arr_delay),</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_delay2 =</span> <span class="fu">mean</span>(arr_delay[arr_delay <span class="sc">&gt;</span> <span class="dv">0</span>]) <span class="co"># the average positive delay</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 5
# Groups:   year, month [12]
    year month   day avg_delay1 avg_delay2
   &lt;int&gt; &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1  2013     1     1     12.7         32.5
 2  2013     1     2     12.7         32.0
 3  2013     1     3      5.73        27.7
 4  2013     1     4     -1.93        28.3
 5  2013     1     5     -1.53        22.6
 6  2013     1     6      4.24        24.4
 7  2013     1     7     -4.95        27.8
 8  2013     1     8     -3.23        20.8
 9  2013     1     9     -0.264       25.6
10  2013     1    10     -5.90        27.3
# … with 355 more rows</code></pre>
</div>
</div>
<ul>
<li><strong>Medidas de rango:</strong> <code>min(x)</code>, <code>quantile(x, 0.25)</code>, <code>max(x)</code>. Los cuantiles son una generalización de la mediana. Por ejemplo, <code>quantile(x, 0.25)</code> encontrará un valor de x que sea mayor a 25% de los valores, y menor que el 75% restante.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">first =</span> <span class="fu">min</span>(dep_time),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">last =</span> <span class="fu">max</span>(dep_time)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 5
# Groups:   year, month [12]
    year month   day first  last
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1   517  2356
 2  2013     1     2    42  2354
 3  2013     1     3    32  2349
 4  2013     1     4    25  2358
 5  2013     1     5    14  2357
 6  2013     1     6    16  2355
 7  2013     1     7    49  2359
 8  2013     1     8   454  2351
 9  2013     1     9     2  2252
10  2013     1    10     3  2320
# … with 355 more rows</code></pre>
</div>
</div>
<ul>
<li><strong>Medidas de dispersión:</strong> <code>sd(x)</code>, <code>IQR(x)</code>, <code>mad(x)</code>. La raíz cuadrad de la varianza o desviación estándar <code>sd(x)</code> es una medida estándar de dispersión. El rango intercuartil <code>IQR()</code> y la desviación media absoluta <code>mad(x</code>) son medidas robustas equivalentes que pueden ser más útiles si tienes <strong>valores atípicos</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">distance_sd =</span> <span class="fu">sd</span>(distance)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(distance_sd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 2
   dest  distance_sd
   &lt;chr&gt;       &lt;dbl&gt;
 1 EGE         10.5 
 2 SAN         10.4 
 3 SFO         10.2 
 4 HNL         10.0 
 5 SEA          9.98
 6 LAS          9.91
 7 PDX          9.87
 8 PHX          9.86
 9 LAX          9.66
10 IND          9.46
# … with 94 more rows</code></pre>
</div>
</div>
<p>Estas funciones son complementarias al filtrado en rangos. El filtrado te proporciona todas las variables, con cada observación en una fila distinta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(dep_time))) <span class="sc">%&gt;%</span> </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r <span class="sc">%in%</span> <span class="fu">range</span>(r)) <span class="sc">%&gt;%</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `year`, `month`, `day`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 770 × 4
# Groups:   year, month, day [365]
    year month   day     r
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1   831
 2  2013     1     1     1
 3  2013     1     2   928
 4  2013     1     2     1
 5  2013     1     3   900
 6  2013     1     3     1
 7  2013     1     4   908
 8  2013     1     4     1
 9  2013     1     4     1
10  2013     1     5   717
# … with 760 more rows</code></pre>
</div>
</div>
<ul>
<li><strong>Conteos:</strong> has visto <code>n()</code>, que no toma argumentos y que devuelve el tamaño del grupo actual. Para contar la cantidad de valores no faltantes, usa <code>sum(!is.na (x))</code>. Para contar la cantidad de valores distintos (únicos), usa <code>n_distinct(x)</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué destinos tienen la mayoría de las aerolíneas?</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">carriers =</span> <span class="fu">n_distinct</span>(carrier)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(carriers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 2
   dest  carriers
   &lt;chr&gt;    &lt;int&gt;
 1 ATL          7
 2 BOS          7
 3 CLT          7
 4 ORD          7
 5 TPA          7
 6 AUS          6
 7 DCA          6
 8 DTW          6
 9 IAD          6
10 MSP          6
# … with 94 more rows</code></pre>
</div>
</div>
<p>Los conteos son tan útiles que <strong>dplyr</strong> proporciona un ayudante simple si todo lo que quieres es un conteo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 104 × 2
   dest      n
   &lt;chr&gt; &lt;int&gt;
 1 ABQ     254
 2 ACK     264
 3 ALB     418
 4 ANC       8
 5 ATL   16837
 6 AUS    2411
 7 AVL     261
 8 BDL     412
 9 BGR     358
10 BHM     269
# … with 94 more rows</code></pre>
</div>
</div>
<p>Opcionalmente puedes proporcionar una variable de ponderación. Por ejemplo, podrías usar esto para <strong>“contar”</strong> (sumar) el número total de millas que voló un avión:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">wt =</span> distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,037 × 2
   tailnum      n
   &lt;chr&gt;    &lt;dbl&gt;
 1 D942DN    3418
 2 N0EGMQ  239143
 3 N10156  109664
 4 N102UW   25722
 5 N103US   24619
 6 N104UW   24616
 7 N10575  139903
 8 N105UW   23618
 9 N107US   21677
10 N108UW   32070
# … with 4,027 more rows</code></pre>
</div>
</div>
<ul>
<li><strong>Conteos y proporciones de valores lógicos:</strong> <code>sum(x &gt; 10)</code>, <code>mean(y == 0)</code>. Cuando se usan con funciones numéricas, <code>TRUE</code> se convierte en <strong>1</strong> y <code>FALSE</code> en <strong>0</strong>. Esto hace que <code>sum()</code> y <code>mean()</code> sean muy útiles: <code>sum(x)</code> te da la cantidad de <code>TRUE</code> en <code>x</code>, y <code>mean(x)</code> te da la proporción.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Cuántos vuelos salieron antes de las 5 am? </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (estos generalmente son vuelos demorados del día anterior)</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_early =</span> <span class="fu">sum</span>(dep_time <span class="sc">&lt;</span> <span class="dv">500</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day n_early
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
 1  2013     1     1       0
 2  2013     1     2       3
 3  2013     1     3       4
 4  2013     1     4       3
 5  2013     1     5       3
 6  2013     1     6       2
 7  2013     1     7       2
 8  2013     1     8       1
 9  2013     1     9       3
10  2013     1    10       3
# … with 355 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ¿Qué proporción de vuelos se retrasan más de una hora?</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>not_cancelled <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hour_prop =</span> <span class="fu">mean</span>(arr_delay <span class="sc">&gt;</span> <span class="dv">60</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day hour_prop
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;
 1  2013     1     1    0.0722
 2  2013     1     2    0.0851
 3  2013     1     3    0.0567
 4  2013     1     4    0.0396
 5  2013     1     5    0.0349
 6  2013     1     6    0.0470
 7  2013     1     7    0.0333
 8  2013     1     8    0.0213
 9  2013     1     9    0.0202
10  2013     1    10    0.0183
# … with 355 more rows</code></pre>
</div>
</div>
<section id="agrupación-por-múltiples-variables" class="level3">
<h3 class="anchored" data-anchor-id="agrupación-por-múltiples-variables">Agrupación por múltiples variables</h3>
<p>Cuando agrupas por múltiples variables, cada resumen se desprende de un nivel de la agrupación. Eso hace que sea más fácil acumular progresivamente en un conjunto de datos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>daily <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, year, month, day)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>(per_day   <span class="ot">&lt;-</span> <span class="fu">summarise</span>(daily, <span class="at">flights =</span> <span class="fu">n</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year', 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 365 × 4
# Groups:   year, month [12]
    year month   day flights
   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
 1  2013     1     1     842
 2  2013     1     2     943
 3  2013     1     3     914
 4  2013     1     4     915
 5  2013     1     5     720
 6  2013     1     6     832
 7  2013     1     7     933
 8  2013     1     8     899
 9  2013     1     9     902
10  2013     1    10     932
# … with 355 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>(per_month <span class="ot">&lt;-</span> <span class="fu">summarise</span>(per_day, <span class="at">flights =</span> <span class="fu">sum</span>(flights)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
# Groups:   year [1]
    year month flights
   &lt;int&gt; &lt;int&gt;   &lt;int&gt;
 1  2013     1   27004
 2  2013     2   24951
 3  2013     3   28834
 4  2013     4   28330
 5  2013     5   28796
 6  2013     6   28243
 7  2013     7   29425
 8  2013     8   29327
 9  2013     9   27574
10  2013    10   28889
11  2013    11   27268
12  2013    12   28135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>(per_year  <span class="ot">&lt;-</span> <span class="fu">summarise</span>(per_month, <span class="at">flights =</span> <span class="fu">sum</span>(flights)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
   year flights
  &lt;int&gt;   &lt;int&gt;
1  2013  336776</code></pre>
</div>
</div>
<p>Ten cuidado al acumular resúmenes progresivamente: está bien para las sumas y los recuentos, pero debes pensar en la ponderación de las medias y las varianzas, además de que no es posible hacerlo exactamente para estadísticas basadas en rangos como la mediana. En otras palabras, la suma de las sumas agrupadas es la suma total, pero la mediana de las medianas agrupadas no es la mediana general.</p>
</section>
<section id="desagrupar" class="level3">
<h3 class="anchored" data-anchor-id="desagrupar">Desagrupar</h3>
<p>Si necesitas eliminar la agrupación y regresar a las operaciones en datos desagrupados, usa ungroup().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>daily <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>             <span class="co"># no longer grouped by date</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">flights =</span> <span class="fu">n</span>())  <span class="co"># all flights</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  flights
    &lt;int&gt;
1  336776</code></pre>
</div>
</div>
</section>
<section id="transformaciones-agrupadas-y-filtros" class="level3">
<h3 class="anchored" data-anchor-id="transformaciones-agrupadas-y-filtros">Transformaciones agrupadas (y filtros)</h3>
<p>La agrupación es más útil si se utiliza junto con summarise(), pero también puedes hacer operaciones convenientes con <code>mutate()</code> y <code>filter()</code>:</p>
<ul>
<li>Encuentra los peores miembros de cada grupo:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, day) <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">rank</span>(<span class="fu">desc</span>(arr_delay)) <span class="sc">&lt;</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,306 × 7
# Groups:   year, month, day [365]
    year month   day dep_delay arr_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2013     1     1       853       851      184       41
 2  2013     1     1       290       338     1134      213
 3  2013     1     1       260       263      266       46
 4  2013     1     1       157       174      213       60
 5  2013     1     1       216       222      708      121
 6  2013     1     1       255       250      589      115
 7  2013     1     1       285       246     1085      146
 8  2013     1     1       192       191      199       44
 9  2013     1     1       379       456     1092      222
10  2013     1     2       224       207      550       94
# … with 3,296 more rows</code></pre>
</div>
</div>
<p>Encuentra todos los grupos más grandes que un determinado umbral:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>popular_dests <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">%&gt;%</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">365</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>popular_dests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 332,577 × 19
# Groups:   dest [77]
    year month   day dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵ carrier
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
 1  2013     1     1      517        515       2     830     819      11 UA     
 2  2013     1     1      533        529       4     850     830      20 UA     
 3  2013     1     1      542        540       2     923     850      33 AA     
 4  2013     1     1      544        545      -1    1004    1022     -18 B6     
 5  2013     1     1      554        600      -6     812     837     -25 DL     
 6  2013     1     1      554        558      -4     740     728      12 UA     
 7  2013     1     1      555        600      -5     913     854      19 B6     
 8  2013     1     1      557        600      -3     709     723     -14 EV     
 9  2013     1     1      557        600      -3     838     846      -8 B6     
10  2013     1     1      558        600      -2     753     745       8 AA     
# … with 332,567 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;,
#   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
#   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names
#   ¹​sched_dep_time, ²​dep_delay, ³​arr_time, ⁴​sched_arr_time, ⁵​arr_delay</code></pre>
</div>
</div>
<ul>
<li>Estandariza para calcular las métricas por grupo:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>popular_dests <span class="sc">%&gt;%</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(arr_delay <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_delay =</span> arr_delay <span class="sc">/</span> <span class="fu">sum</span>(arr_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day, dest, arr_delay, prop_delay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 131,106 × 6
# Groups:   dest [77]
    year month   day dest  arr_delay prop_delay
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1  2013     1     1 IAH          11  0.000111 
 2  2013     1     1 IAH          20  0.000201 
 3  2013     1     1 MIA          33  0.000235 
 4  2013     1     1 ORD          12  0.0000424
 5  2013     1     1 FLL          19  0.0000938
 6  2013     1     1 ORD           8  0.0000283
 7  2013     1     1 LAX           7  0.0000344
 8  2013     1     1 DFW          31  0.000282 
 9  2013     1     1 ATL          12  0.0000400
10  2013     1     1 DTW          16  0.000116 
# … with 131,096 more rows</code></pre>
</div>
</div>
<p>Un filtro agrupado es una transformación agrupada seguida de un filtro desagrupado. En general, preferimos evitarlos, excepto para las manipulaciones rápidas y sucias: de lo contrario, es difícil comprobar que has hecho la manipulación correctamente.</p>
<p>Las funciones que trabajan de forma más natural en transformaciones agrupadas y filtros se conocen como funciones de ventana o window functions (frente a las funciones de resumen utilizadas para los resúmenes). Puedes obtener más información sobre las funciones de ventana útiles en la viñeta correspondiente: <code>vignette("window-functions")</code>.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>